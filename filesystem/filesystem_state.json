{"file_contents":{"client/src/lib/life/mr_pbj.ts":{"content":"// PBJ Health - Mr. PBJ Coach\n// Coaching tips based on daily/weekly data\n\nexport async function mrPBJCoach(report: any): Promise<string> {\n  const tips: string[] = [];\n\n  // Streak-based tips\n  if (report.streakColor === 'GREEN') {\n    tips.push('You kept the full streak—awesome consistency!');\n  }\n  if (report.streakColor === 'YELLOW') {\n    tips.push(\n      'Solid day: 2/3 pillars. Try a 10‑min walk or lighter dinner to hit 3/3.'\n    );\n  }\n  if (report.streakColor === 'RED') {\n    tips.push(\n      'Tough day happens. Focus on sleep + one easy win (short workout or mindful meal).'\n    );\n  }\n\n  // Calorie-based tips\n  if (report.calories?.status === 'OV') {\n    tips.push(\n      'Plan a protein‑forward breakfast and pre‑log dinner to avoid spillover.'\n    );\n  }\n\n  // Sleep tips\n  if (report.sleepMin < 420) {\n    tips.push('Aim lights‑out 30–45 min earlier tonight.');\n  }\n\n  // Recovery tips\n  if (\n    report.drugs?.recoveryDays &&\n    Object.values(report.drugs.recoveryDays).some((d: any) => d > 0)\n  ) {\n    tips.push('Proud of your clean streak—keep stacking days.');\n  }\n\n  if (report.drugs?.withdrawal?.symptom) {\n    tips.push('Try sugar‑free gum or a brief walk when cravings spike.');\n  }\n\n  // Dream tips\n  if ((report.dream?.type || '').toLowerCase().includes('nightmare')) {\n    tips.push('Reduce intense media before bed and try 5‑min breathing.');\n  }\n\n  // Meditation tip\n  if (report.meditationMin === 0 || !report.meditationMin) {\n    tips.push('Even 5 minutes of meditation can help with stress and focus.');\n  }\n\n  return tips.join(' ');\n}\n","size_bytes":1593},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/pages/mental.tsx":{"content":"// PBJ Health - Mental Health Page\nimport { useState } from 'react';\nimport { useAuth } from '@/hooks/useAuth';\nimport { DashboardCard } from '@/components/DashboardCard';\nimport { Button } from '@/components/ui/button';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { ArrowLeft } from 'lucide-react';\nimport { Link } from 'wouter';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useToast } from '@/hooks/use-toast';\nimport { getTodayISO } from '@/lib/dateUtils';\n\nexport default function Mental() {\n  const { isAuthenticated } = useAuth();\n  const [rating, setRating] = useState<'great' | 'ok' | 'bad'>('ok');\n  const [why, setWhy] = useState('');\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const mutation = useMutation({\n    mutationFn: async (data: { date: string; rating: string; why?: string }) => {\n      await apiRequest('POST', '/api/mental', data);\n    },\n    onSuccess: () => {\n      toast({ title: 'Mental health logged successfully!' });\n      queryClient.invalidateQueries({ queryKey: ['/api/analytics/daily'] });\n      setWhy('');\n    },\n    onError: (error: Error) => {\n      toast({ title: 'Error', description: error.message, variant: 'destructive' });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    mutation.mutate({ date: getTodayISO(), rating, why: why || undefined });\n  };\n\n  if (!isAuthenticated) return null;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b sticky top-0 bg-background/95 backdrop-blur z-50\">\n        <div className=\"max-w-2xl mx-auto px-4 py-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Today\n            </Button>\n          </Link>\n        </div>\n      </header>\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\n        <h1 className=\"text-3xl font-bold mb-8\">Mental Health Check-In</h1>\n        <DashboardCard title=\"How are you feeling today?\">\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <div>\n              <Label>Your mood yesterday</Label>\n              <div className=\"grid grid-cols-3 gap-4 mt-2\">\n                <Button\n                  type=\"button\"\n                  variant={rating === 'great' ? 'default' : 'outline'}\n                  onClick={() => setRating('great')}\n                  data-testid=\"button-rating-great\"\n                >\n                  Great\n                </Button>\n                <Button\n                  type=\"button\"\n                  variant={rating === 'ok' ? 'default' : 'outline'}\n                  onClick={() => setRating('ok')}\n                  data-testid=\"button-rating-ok\"\n                >\n                  OK\n                </Button>\n                <Button\n                  type=\"button\"\n                  variant={rating === 'bad' ? 'default' : 'outline'}\n                  onClick={() => setRating('bad')}\n                  data-testid=\"button-rating-bad\"\n                >\n                  Bad\n                </Button>\n              </div>\n            </div>\n            <div>\n              <Label htmlFor=\"why\">Why? (Optional)</Label>\n              <Textarea\n                id=\"why\"\n                value={why}\n                onChange={(e) => setWhy(e.target.value)}\n                placeholder=\"What made it great/ok/bad?\"\n                rows={4}\n                data-testid=\"input-why\"\n              />\n            </div>\n            <Button type=\"submit\" disabled={mutation.isPending} data-testid=\"button-log-mental\">\n              {mutation.isPending ? 'Logging...' : 'Log Mental Health'}\n            </Button>\n          </form>\n        </DashboardCard>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3905},"client/src/pages/sleep.tsx":{"content":"// PBJ Health - Sleep Logging Page\nimport { useState } from 'react';\nimport { useAuth } from '@/hooks/useAuth';\nimport { DashboardCard } from '@/components/DashboardCard';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { ArrowLeft } from 'lucide-react';\nimport { Link } from 'wouter';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useToast } from '@/hooks/use-toast';\nimport { isUnauthorizedError } from '@/lib/authUtils';\n\nexport default function Sleep() {\n  const { isAuthenticated } = useAuth();\n  const [start, setStart] = useState('');\n  const [end, setEnd] = useState('');\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const mutation = useMutation({\n    mutationFn: async (data: { startAt: string; endAt: string }) => {\n      await apiRequest('POST', '/api/sleep', data);\n    },\n    onSuccess: () => {\n      toast({ title: 'Sleep logged successfully!' });\n      queryClient.invalidateQueries({ queryKey: ['/api/analytics/daily'] });\n      setStart('');\n      setEnd('');\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: 'Unauthorized',\n          description: 'You are logged out. Logging in again...',\n          variant: 'destructive',\n        });\n        setTimeout(() => { window.location.href = '/api/login'; }, 500);\n        return;\n      }\n      toast({ title: 'Error', description: error.message, variant: 'destructive' });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!start || !end) {\n      toast({ title: 'Error', description: 'Please fill in all fields', variant: 'destructive' });\n      return;\n    }\n    mutation.mutate({ startAt: start, endAt: end });\n  };\n\n  if (!isAuthenticated) return null;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b sticky top-0 bg-background/95 backdrop-blur z-50\">\n        <div className=\"max-w-2xl mx-auto px-4 py-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Today\n            </Button>\n          </Link>\n        </div>\n      </header>\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\n        <h1 className=\"text-3xl font-bold mb-8\">Log Sleep</h1>\n        <DashboardCard title=\"Sleep Session\">\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"start\">Sleep Start</Label>\n              <Input\n                id=\"start\"\n                type=\"datetime-local\"\n                value={start}\n                onChange={(e) => setStart(e.target.value)}\n                data-testid=\"input-sleep-start\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"end\">Sleep End</Label>\n              <Input\n                id=\"end\"\n                type=\"datetime-local\"\n                value={end}\n                onChange={(e) => setEnd(e.target.value)}\n                data-testid=\"input-sleep-end\"\n              />\n            </div>\n            <Button type=\"submit\" disabled={mutation.isPending} data-testid=\"button-log-sleep\">\n              {mutation.isPending ? 'Logging...' : 'Log Sleep'}\n            </Button>\n          </form>\n        </DashboardCard>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3501},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/lib/life/report.ts":{"content":"// PBJ Health - Lyfe Report Generator\n// Generate formatted reports for different time breakdowns\n\nconst fmtHM = (m: number) =>\n  `${Math.floor(m / 60)}h${String(m % 60).padStart(2, '0')}m`;\n\nexport type BreakdownType = 'Previous Day' | '7 Day' | '30 Day' | '3 Month';\n\nexport function generateLyfeReport(input: {\n  breakdown: BreakdownType;\n  streakColor: 'GREEN' | 'YELLOW' | 'RED';\n  gymMin: number;\n  sleepMin: number;\n  calories: {\n    intake: number;\n    goal: number;\n    status: 'UN' | 'OV' | 'GOAL';\n    delta: number;\n  };\n  mental: 'GOOD' | 'OK' | 'BAD';\n  meditationMin: number;\n  dream: { type?: string; short?: string } | null;\n  social: { totalMin: number; activities: string[] };\n  hobbies: { totalMin: number; activities: string[] };\n  work: { totalMin: number; stress: 'low' | 'medium' | 'high' | null };\n  drugs: {\n    summary: string;\n    withdrawal?: {\n      drug: string;\n      symptom: string;\n      strength: 'low' | 'medium' | 'high';\n    } | null;\n    recoveryDays?: Record<string, number>;\n  };\n}): string {\n  const L: string[] = [];\n\n  L.push(`Here is ${input.breakdown} Lyfe Report:`);\n  L.push(`Streak Status: ${input.streakColor}`);\n  L.push(`1. Gym Time: ${fmtHM(input.gymMin)}`);\n  L.push(`2. Sleep: ${fmtHM(input.sleepMin)}`);\n\n  const c = input.calories;\n  L.push(\n    `3. Calories ${c.intake}/${c.goal} ${c.status} ${c.delta >= 0 ? `+${c.delta}` : `${c.delta}`}`\n  );\n\n  L.push(`You listed your Mental Health as: ${input.mental}.`);\n  L.push(\n    `Meditation: ${input.meditationMin > 0 ? fmtHM(input.meditationMin) : 'None'}.`\n  );\n\n  if (input.dream) {\n    L.push(\n      `Dream Analysis: ${input.dream.type || '—'} - ${input.dream.short || '—'}.`\n    );\n  }\n\n  const s = input.social;\n  L.push(\n    `Social Presence: You spent, ${fmtHM(s.totalMin)}, being social yesterday:`\n  );\n  s.activities.slice(0, 3).forEach((a, i) => L.push(`${i + 1}. ${a}`));\n\n  const h = input.hobbies;\n  L.push(`Hobbies: You spent, ${fmtHM(h.totalMin)}, doing hobbies.`);\n  h.activities.slice(0, 3).forEach((a, i) => L.push(`${i + 1}. ${a}`));\n\n  const w = input.work;\n  if (w.totalMin > 0) {\n    L.push(\n      `Work: You worked for ${Math.round(w.totalMin / 60)} hours and had a ${w.stress ?? '—'} stress day.`\n    );\n  }\n\n  const d = input.drugs;\n  L.push(\n    `Drug Use: You consumed; ${d.summary}, yesterday.${d.withdrawal ? ` You also listed your ${d.withdrawal.drug} withdrawal symptoms of \"${d.withdrawal.symptom}\" as \"${d.withdrawal.strength}\".` : ''}`\n  );\n\n  return L.join('\\n');\n}\n","size_bytes":2513},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/pages/weight.tsx":{"content":"// PBJ Health - Weight Logging Page\nimport { useState } from 'react';\nimport { useAuth } from '@/hooks/useAuth';\nimport { DashboardCard } from '@/components/DashboardCard';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { ArrowLeft } from 'lucide-react';\nimport { Link } from 'wouter';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useToast } from '@/hooks/use-toast';\nimport { getTodayISO } from '@/lib/dateUtils';\n\nexport default function Weight() {\n  const { isAuthenticated } = useAuth();\n  const [weightKg, setWeightKg] = useState('');\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const mutation = useMutation({\n    mutationFn: async (data: { date: string; weightKg: number }) => {\n      await apiRequest('POST', '/api/weight', data);\n    },\n    onSuccess: () => {\n      toast({ title: 'Weight logged successfully!' });\n      queryClient.invalidateQueries({ queryKey: ['/api/weight'] });\n      setWeightKg('');\n    },\n    onError: (error: Error) => {\n      toast({ title: 'Error', description: error.message, variant: 'destructive' });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    const weight = parseFloat(weightKg);\n    if (isNaN(weight) || weight <= 0) {\n      toast({ title: 'Error', description: 'Please enter a valid weight', variant: 'destructive' });\n      return;\n    }\n    mutation.mutate({ date: getTodayISO(), weightKg: weight });\n  };\n\n  if (!isAuthenticated) return null;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b sticky top-0 bg-background/95 backdrop-blur z-50\">\n        <div className=\"max-w-2xl mx-auto px-4 py-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Today\n            </Button>\n          </Link>\n        </div>\n      </header>\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\n        <h1 className=\"text-3xl font-bold mb-8\">Log Weight</h1>\n        <DashboardCard title=\"Body Metrics\">\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"weight\">Weight (kg)</Label>\n              <Input\n                id=\"weight\"\n                type=\"number\"\n                step=\"0.1\"\n                value={weightKg}\n                onChange={(e) => setWeightKg(e.target.value)}\n                placeholder=\"Enter weight in kg\"\n                data-testid=\"input-weight\"\n              />\n            </div>\n            <Button type=\"submit\" disabled={mutation.isPending} data-testid=\"button-log-weight\">\n              {mutation.isPending ? 'Logging...' : 'Log Weight'}\n            </Button>\n          </form>\n        </DashboardCard>\n      </div>\n    </div>\n  );\n}\n","size_bytes":2962},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"server/index.ts":{"content":"// server/index.ts\nimport express, {\n  type Request,\n  type Response,\n  type NextFunction,\n} from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\n\n// raw body + urlencoded\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\napp.use(\n  express.json({\n    verify: (req, _res, buf) => {\n      (req as any).rawBody = buf;\n    },\n  }),\n);\napp.use(express.urlencoded({ extended: false }));\n\n// API log\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let captured: any;\n  const orig = res.json;\n  (res as any).json = function (body: any, ...args: any[]) {\n    captured = body;\n    return orig.apply(res, [body, ...args]);\n  };\n  res.on(\"finish\", () => {\n    if (path.startsWith(\"/api\")) {\n      let line = `${req.method} ${path} ${res.statusCode} in ${Date.now() - start}ms`;\n      if (captured) line += ` :: ${JSON.stringify(captured)}`;\n      if (line.length > 80) line = line.slice(0, 79) + \"…\";\n      log(line);\n    }\n  });\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    res\n      .status(err?.status || err?.statusCode || 500)\n      .json({ message: err?.message || \"Internal Server Error\" });\n    throw err;\n  });\n\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  server.listen({ port, host: \"0.0.0.0\", reusePort: true }, () =>\n    log(`serving on port ${port}`),\n  );\n})();\n","size_bytes":1660},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/StreakBadge.tsx":{"content":"// PBJ Health - Streak Badge Component\n// Duolingo-style colored badges for daily streaks\nimport { CheckCircle2, AlertTriangle, XCircle } from 'lucide-react';\n\ninterface StreakBadgeProps {\n  color: 'green' | 'yellow' | 'red';\n  count: number;\n  label?: string;\n  size?: 'sm' | 'md' | 'lg';\n}\n\nexport function StreakBadge({ color, count, label, size = 'md' }: StreakBadgeProps) {\n  const sizeClasses = {\n    sm: 'h-8 w-8 text-sm',\n    md: 'h-12 w-12 text-base',\n    lg: 'h-16 w-16 text-lg',\n  };\n\n  const iconSizeClasses = {\n    sm: 'h-4 w-4',\n    md: 'h-5 w-5',\n    lg: 'h-6 w-6',\n  };\n\n  const bgClasses = {\n    green: 'bg-streak-green text-streak-green-foreground',\n    yellow: 'bg-streak-yellow text-streak-yellow-foreground',\n    red: 'bg-streak-red text-streak-red-foreground',\n  };\n\n  const Icon = color === 'green' ? CheckCircle2 : color === 'yellow' ? AlertTriangle : XCircle;\n\n  return (\n    <div className=\"inline-flex flex-col items-center gap-2\" data-testid={`badge-streak-${color}`}>\n      <div\n        className={`rounded-full flex items-center justify-center font-bold ${sizeClasses[size]} ${bgClasses[color]}`}\n      >\n        <Icon className={iconSizeClasses[size]} />\n      </div>\n      <span className=\"text-sm font-semibold\">{count} day{count !== 1 ? 's' : ''}</span>\n      {label && (\n        <span className=\"text-xs font-medium text-muted-foreground\">{label}</span>\n      )}\n    </div>\n  );\n}\n","size_bytes":1416},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/pages/profile.tsx":{"content":"// PBJ Health - Profile & Settings Page\nimport { useState, useEffect } from 'react';\nimport { useAuth } from '@/hooks/useAuth';\nimport { DashboardCard } from '@/components/DashboardCard';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { ArrowLeft } from 'lucide-react';\nimport { Link } from 'wouter';\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useToast } from '@/hooks/use-toast';\n\nexport default function Profile() {\n  const { isAuthenticated, user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: goals, isLoading: goalsLoading } = useQuery({\n    queryKey: ['/api/goals'],\n    enabled: isAuthenticated,\n  });\n\n  const [goalWeight, setGoalWeight] = useState('');\n  const [kcalGoal, setKcalGoal] = useState('2000');\n  const [stepGoal, setStepGoal] = useState('10000');\n\n  // Update state when goals data loads\n  useEffect(() => {\n    if (goals) {\n      setGoalWeight(goals.goalWeightKg?.toString() || '');\n      setKcalGoal(goals.kcalGoal?.toString() || '2000');\n      setStepGoal(goals.stepGoal?.toString() || '10000');\n    }\n  }, [goals]);\n\n  const mutation = useMutation({\n    mutationFn: async (data: any) => {\n      await apiRequest('PUT', '/api/goals', data);\n    },\n    onSuccess: () => {\n      toast({ title: 'Goals updated successfully!' });\n      queryClient.invalidateQueries({ queryKey: ['/api/goals'] });\n    },\n    onError: (error: Error) => {\n      toast({ title: 'Error', description: error.message, variant: 'destructive' });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    mutation.mutate({\n      goalWeightKg: goalWeight ? parseFloat(goalWeight) : undefined,\n      kcalGoal: parseInt(kcalGoal),\n      stepGoal: parseInt(stepGoal),\n    });\n  };\n\n  if (!isAuthenticated) return null;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b sticky top-0 bg-background/95 backdrop-blur z-50\">\n        <div className=\"max-w-2xl mx-auto px-4 py-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Today\n            </Button>\n          </Link>\n        </div>\n      </header>\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\n        <h1 className=\"text-3xl font-bold mb-8\">Profile & Settings</h1>\n        \n        <DashboardCard title=\"User Info\" className=\"mb-6\">\n          <div className=\"space-y-2\">\n            <p className=\"text-sm\">\n              <span className=\"font-medium\">Name:</span> {user?.firstName} {user?.lastName}\n            </p>\n            <p className=\"text-sm\">\n              <span className=\"font-medium\">Email:</span> {user?.email}\n            </p>\n          </div>\n        </DashboardCard>\n\n        <DashboardCard title=\"Health Goals\">\n          {goalsLoading ? (\n            <div className=\"text-sm text-muted-foreground\">Loading goals...</div>\n          ) : (\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"goalWeight\">Goal Weight (kg)</Label>\n              <Input\n                id=\"goalWeight\"\n                type=\"number\"\n                step=\"0.1\"\n                value={goalWeight}\n                onChange={(e) => setGoalWeight(e.target.value)}\n                placeholder=\"75.0\"\n                data-testid=\"input-goal-weight\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"kcalGoal\">Daily Calorie Goal</Label>\n              <Input\n                id=\"kcalGoal\"\n                type=\"number\"\n                value={kcalGoal}\n                onChange={(e) => setKcalGoal(e.target.value)}\n                data-testid=\"input-kcal-goal\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"stepGoal\">Daily Step Goal</Label>\n              <Input\n                id=\"stepGoal\"\n                type=\"number\"\n                value={stepGoal}\n                onChange={(e) => setStepGoal(e.target.value)}\n                data-testid=\"input-step-goal\"\n              />\n            </div>\n            <Button type=\"submit\" disabled={mutation.isPending} data-testid=\"button-save-goals\">\n              {mutation.isPending ? 'Saving...' : 'Save Goals'}\n            </Button>\n          </form>\n          )}\n        </DashboardCard>\n      </div>\n    </div>\n  );\n}\n","size_bytes":4565},"client/src/lib/life/evaluators.ts":{"content":"// PBJ Health - Life Evaluators\n// Summarize work, social, hobbies\n\nexport function summarizeWork(day: {\n  logs: { durationMin: number; stress?: 'low' | 'medium' | 'high' }[];\n}): { totalMin: number; peakStress: 'low' | 'medium' | 'high' | null } {\n  const total = day.logs.reduce((s, l) => s + (l.durationMin || 0), 0);\n  const c = day.logs.reduce(\n    (acc, l) => {\n      const v = l.stress || 'low';\n      acc[v] = (acc[v] || 0) + 1;\n      return acc;\n    },\n    {} as Record<string, number>\n  );\n\n  const peak =\n    (['high', 'medium', 'low'] as const).find((k) => c[k] && c[k] > 0) || null;\n\n  return { totalMin: total, peakStress: peak };\n}\n\nexport function topN<T extends { name: string; durationMin?: number }>(\n  arr: T[],\n  n = 3\n): string[] {\n  return arr\n    .sort((a, b) => (b.durationMin || 0) - (a.durationMin || 0))\n    .slice(0, n)\n    .map((x) => x.name);\n}\n","size_bytes":876},"server/storage.ts":{"content":"// server/storage.ts\nimport Database from \"better-sqlite3\";\nimport OpenAI from \"openai\";\n\nconst db = new Database(\"pbj.sqlite\");\ndb.pragma(\"foreign_keys = ON\");\n\n/* ---------------- Schema (idempotent) ---------------- */\ndb.exec(`\ncreate table if not exists users (\n  id text primary key,\n  created_at text not null default (datetime('now'))\n);\n\ncreate table if not exists sleep_sessions (\n  id text primary key, user_id text not null, start_at text not null, end_at text not null,\n  duration_min integer not null,\n  foreign key(user_id) references users(id) on delete cascade\n);\n\ncreate table if not exists body_metrics (\n  id text primary key, user_id text not null, date text not null, weight_kg real not null,\n  foreign key(user_id) references users(id) on delete cascade\n);\n\ncreate table if not exists meals (\n  id text primary key, user_id text not null, date text not null, calories integer not null, \n  protein_g real, fat_g real, carbs_g real, notes text,\n  foreign key(user_id) references users(id) on delete cascade\n);\n\ncreate table if not exists workouts (\n  id text primary key, user_id text not null, date text not null, start_at text not null, end_at text not null,\n  duration_min integer not null,\n  foreign key(user_id) references users(id) on delete cascade\n);\n\ncreate table if not exists mental_logs (\n  id text primary key, user_id text not null, date text not null, rating text not null, why text,\n  foreign key(user_id) references users(id) on delete cascade,\n  unique(user_id,date)\n);\n\ncreate table if not exists meditation_sessions (\n  id text primary key, user_id text not null, date text not null, duration_min integer not null,\n  foreign key(user_id) references users(id) on delete cascade\n);\n\ncreate table if not exists goals (\n  user_id text primary key, kcal_goal integer default 2000, \n  updated_at text not null default (datetime('now')),\n  foreign key(user_id) references users(id) on delete cascade\n);\n`);\n\n// Migrate existing tables to add new columns\ntry {\n  db.exec(`ALTER TABLE meals ADD COLUMN fat_g real`);\n} catch (e) { /* column already exists */ }\ntry {\n  db.exec(`ALTER TABLE meals ADD COLUMN carbs_g real`);\n} catch (e) { /* column already exists */ }\ntry {\n  db.exec(`ALTER TABLE meals ADD COLUMN notes text`);\n} catch (e) { /* column already exists */ }\n\n// Migrate goals table - drop and recreate with new schema\ntry {\n  const existingGoals = db.prepare(`SELECT user_id, data_json FROM goals`).all() as any[];\n  db.exec(`DROP TABLE IF EXISTS goals_old`);\n  db.exec(`ALTER TABLE goals RENAME TO goals_old`);\n  db.exec(`\n    CREATE TABLE goals (\n      user_id text primary key, \n      kcal_goal integer default 2000, \n      updated_at text not null default (datetime('now')),\n      foreign key(user_id) references users(id) on delete cascade\n    )\n  `);\n  // Migrate data - preserve existing kcalGoal values from data_json\n  for (const row of existingGoals) {\n    let kcalGoal = 2000; // default\n    try {\n      const data = JSON.parse(row.data_json || '{}');\n      kcalGoal = data.kcalGoal || 2000;\n    } catch (e) {\n      console.log('[Migration] Could not parse data_json for user', row.user_id, '- using default');\n    }\n    db.prepare(`INSERT INTO goals (user_id, kcal_goal) VALUES (?, ?)`).run(row.user_id, kcalGoal);\n  }\n  db.exec(`DROP TABLE goals_old`);\n} catch (e) { \n  console.log('[Migration] Goals table migration skipped or already completed');\n}\n\n/* ---------------- helpers ---------------- */\nfunction uuid() {\n  // 32 hex chars — fine for local use\n  return String(Buffer.from(db.prepare(\"select lower(hex(randomblob(16))) as id\").get().id));\n}\nfunction ensureUser(userId: string) {\n  db.prepare(\"insert or ignore into users(id) values (?)\").run(userId);\n}\n\n/* ---------------- users ---------------- */\nexport async function getUser(userId: string) {\n  ensureUser(userId);\n  return { id: userId };\n}\n\n/* ---------------- sleep ---------------- */\nexport async function createSleep(userId: string, startAt: string, endAt: string) {\n  ensureUser(userId);\n  const duration = Math.max(\n    0,\n    Math.round(\n      (Date.parse(endAt) - Date.parse(startAt)) / 60000\n    )\n  );\n  const id = uuid();\n  db.prepare(`insert into sleep_sessions(id,user_id,start_at,end_at,duration_min) values (?,?,?,?,?)`)\n    .run(id, userId, startAt, endAt, duration);\n  return { id, userId, startAt, endAt, durationMin: duration };\n}\n\nexport async function getSleepByDate(userId: string, dateISO: string) {\n  ensureUser(userId);\n  // Match sleep sessions that END on this date (when you wake up)\n  return db.prepare(\n    `select id, start_at as startAt, end_at as endAt, duration_min as durationMin\n     from sleep_sessions\n     where user_id=? and date(end_at)=date(?)\n     order by end_at asc`\n  ).all(userId, dateISO);\n}\n\n/* ---------------- weight ---------------- */\nexport async function createWeight(userId: string, date: string, weightKg: number) {\n  ensureUser(userId);\n  const id = uuid();\n  db.prepare(`insert into body_metrics(id,user_id,date,weight_kg) values (?,?,date(?),?)`)\n    .run(id, userId, date, weightKg);\n  return { id, userId, date, weightKg };\n}\n\nexport async function getWeightHistory(userId: string, limit = 30) {\n  ensureUser(userId);\n  return db.prepare(\n    `select date, weight_kg as weightKg\n     from body_metrics where user_id=? order by date desc limit ?`\n  ).all(userId, limit);\n}\n\n/* ---------------- meals ---------------- */\nexport async function createMeal(userId: string, date: string, calories: number, proteinG?: number, fatG?: number, carbsG?: number, notes?: string) {\n  ensureUser(userId);\n  const id = uuid();\n  db.prepare(`insert into meals(id,user_id,date,calories,protein_g,fat_g,carbs_g,notes) values (?,?,?,?,?,?,?,?)`)\n    .run(id, userId, date, calories, proteinG ?? null, fatG ?? null, carbsG ?? null, notes ?? null);\n  return { id, userId, date, calories, proteinG: proteinG ?? null, fatG: fatG ?? null, carbsG: carbsG ?? null, notes };\n}\n\nexport async function getMealsByDate(userId: string, date: string) {\n  ensureUser(userId);\n  return db.prepare(\n    `select id, date, calories, protein_g as proteinG\n     from meals where user_id=? and date=date(?) order by rowid asc`\n  ).all(userId, date);\n}\n\n/* ---------------- workouts ---------------- */\nexport async function createWorkout(userId: string, date: string, startAt: string, endAt: string) {\n  ensureUser(userId);\n  const duration = Math.max(0, Math.round((Date.parse(endAt) - Date.parse(startAt))/60000));\n  const id = uuid();\n  db.prepare(`insert into workouts(id,user_id,date,start_at,end_at,duration_min) values (?,?,?,?,?,?)`)\n    .run(id, userId, date, startAt, endAt, duration);\n  return { id, userId, date, startAt, endAt, durationMin: duration };\n}\n\nexport async function getWorkoutsByDate(userId: string, date: string) {\n  ensureUser(userId);\n  return db.prepare(\n    `select id, date, start_at as startAt, end_at as endAt, duration_min as durationMin\n     from workouts where user_id=? and date=date(?) order by start_at asc`\n  ).all(userId, date);\n}\n\n/* ---------------- mental ---------------- */\nexport async function createMentalLog(userId: string, date: string, rating: string, why?: string) {\n  ensureUser(userId);\n  const id = uuid();\n  db.prepare(`insert into mental_logs(id,user_id,date,rating,why)\n              values (?,?,?,?,?)\n              on conflict(user_id,date) do update set rating=excluded.rating, why=excluded.why`)\n    .run(id, userId, date, rating, why ?? null);\n  return { userId, date, rating, why: why ?? null };\n}\n\nexport async function getMentalLogByDate(userId: string, date: string) {\n  ensureUser(userId);\n  return db.prepare(\n    `select date, rating, coalesce(why,'') as why\n     from mental_logs where user_id=? and date=date(?)`\n  ).get(userId, date);\n}\n\n/* ---------------- meditation ---------------- */\nexport async function createMeditation(userId: string, date: string, durationMin: number) {\n  ensureUser(userId);\n  const id = uuid();\n  db.prepare(`insert into meditation_sessions(id,user_id,date,duration_min) values (?,?,date(?),?)`)\n    .run(id, userId, date, durationMin);\n  return { id, userId, date, durationMin };\n}\n\nexport async function getMeditationByDate(userId: string, date: string) {\n  ensureUser(userId);\n  return db.prepare(\n    `select id, date, duration_min as durationMin\n     from meditation_sessions where user_id=? and date=date(?) order by rowid asc`\n  ).all(userId, date);\n}\n\n/* ---------------- goals ---------------- */\nexport async function upsertGoals(userId: string, data: any) {\n  ensureUser(userId);\n  const kcalGoal = data.kcalGoal || 2000;\n  db.prepare(`insert into goals(user_id, kcal_goal) values(?,?)\n              on conflict(user_id) do update set kcal_goal=excluded.kcal_goal, updated_at=datetime('now')`)\n    .run(userId, kcalGoal);\n  return { kcalGoal };\n}\n\nexport async function getUserGoals(userId: string) {\n  ensureUser(userId);\n  const row = db.prepare(`select kcal_goal from goals where user_id=?`).get(userId) as any;\n  return row ? { kcalGoal: row.kcal_goal } : null;\n}\n\n/* ---------------- analytics & streaks ---------------- */\nexport async function getDailyAnalytics(userId: string, dateISO: string) {\n  ensureUser(userId);\n  \n  // Get user goals (default: 1700 kcal)\n  const goals = await getUserGoals(userId) || { kcalGoal: 1700 };\n  const kcalGoal = goals.kcalGoal || 1700;\n  \n  // Calculate total sleep hours for the date\n  const sleepSessions = await getSleepByDate(userId, dateISO);\n  const sleepHours = sleepSessions.reduce((total: number, s: any) => total + (s.durationMin / 60), 0);\n  \n  // Calculate total calories for the date\n  const meals = await getMealsByDate(userId, dateISO);\n  const calories = meals.reduce((total: number, m: any) => total + m.calories, 0);\n  \n  // Count workouts for the date\n  const workouts = await getWorkoutsByDate(userId, dateISO);\n  const workoutCount = workouts.length;\n  \n  // Get weight for the date (convert kg to lbs)\n  const weightHistory = await getWeightHistory(userId);\n  const todayWeight = weightHistory.find((w: any) => w.date === dateISO);\n  const weightLbs = todayWeight ? todayWeight.weightKg / 0.453592 : null;\n  \n  // Calculate Big 3 score (0-3)\n  let scoreSmall = 0;\n  if (sleepHours >= 6) scoreSmall++; // Sleep goal: 6+ hours\n  if (calories > 0 && Math.abs(calories - kcalGoal) <= kcalGoal * 0.10) scoreSmall++; // Within ±10% of goal\n  if (workoutCount > 0) scoreSmall++; // At least one workout\n  \n  return {\n    date: dateISO,\n    sleepHours: Number(sleepHours.toFixed(1)),\n    calories,\n    workouts: workoutCount,\n    weight: weightLbs,\n    scoreSmall,\n    kcalGoal,\n  };\n}\n\nexport async function getAnalyticsHistory(userId: string, days: number = 7) {\n  ensureUser(userId);\n  \n  const today = new Date();\n  const history: any[] = [];\n  \n  for (let i = days - 1; i >= 0; i--) {\n    const d = new Date(today);\n    d.setDate(d.getDate() - i);\n    const dateISO = d.toISOString().split('T')[0];\n    const analytics = await getDailyAnalytics(userId, dateISO);\n    history.push(analytics);\n  }\n  \n  return history;\n}\n\nexport async function getStreaks(userId: string) {\n  ensureUser(userId);\n  \n  // Get last 30 days of analytics\n  const today = new Date();\n  const days: any[] = [];\n  \n  for (let i = 0; i < 30; i++) {\n    const d = new Date(today);\n    d.setDate(d.getDate() - i);\n    const dateISO = d.toISOString().split('T')[0];\n    const analytics = await getDailyAnalytics(userId, dateISO);\n    days.push({ date: dateISO, score: analytics.scoreSmall });\n  }\n  \n  days.reverse(); // Oldest first\n  \n  // Calculate streaks from most recent backwards\n  let greenStreak = 0;\n  let onTrackStreak = 0;\n  \n  for (let i = days.length - 1; i >= 0; i--) {\n    const score = days[i].score;\n    \n    // Green streak: consecutive 3/3 days\n    if (score === 3) {\n      greenStreak++;\n    } else if (greenStreak === 0) {\n      // Only count from most recent day\n      break;\n    } else {\n      break;\n    }\n  }\n  \n  // On Track streak: consecutive days with 2+ or 3/3\n  for (let i = days.length - 1; i >= 0; i--) {\n    const score = days[i].score;\n    if (score >= 2) {\n      onTrackStreak++;\n    } else if (onTrackStreak === 0) {\n      break;\n    } else {\n      break;\n    }\n  }\n  \n  return {\n    greenDays: greenStreak,\n    onTrackDays: onTrackStreak,\n  };\n}\n\n/* ---------------- things you can fill later (return empties for now) ------- */\nexport async function createDream(_u:string,_d:string,_t:string,_n:string){ return { ok:true }; }\nexport async function getDreamsByDate(_u:string,_d:string){ return []; }\nexport async function createWorkLog(_u:string,_d:string,_s:string,_a?:string,_b?:string){ return { ok:true }; }\nexport async function getWorkLogsByDate(_u:string,_d:string){ return []; }\nexport async function createSocialLog(_u:string,_d:string,_a:string,_m?:number){ return { ok:true }; }\nexport async function getSocialLogsByDate(_u:string,_d:string){ return []; }\nexport async function createHobby(_u:string,_n:string,_p:boolean){ return { ok:true }; }\nexport async function getUserHobbies(_u:string){ return []; }\nexport async function createHobbySession(_u:string,_h:string,_d:string,_m:number){ return { ok:true }; }\nexport async function createDrugProfile(_u:string,_n:string,_r:boolean,_c?:string){ return { ok:true }; }\nexport async function getUserDrugProfiles(_u:string){ return []; }\nexport async function createDrugUseLog(userId: string, date: string, drugName: string, amount?: string, isPrescribed?: boolean) {\n  ensureUser(userId);\n  const id = uuid();\n  db.prepare(`insert into drug_use_logs(id,user_id,date,drug_name,amount,is_prescribed) values (?,?,?,?,?,?)`)\n    .run(id, userId, date, drugName, amount ?? null, isPrescribed ? 1 : 0);\n  return { id, userId, date, drugName, amount, isPrescribed };\n}\n\nexport async function createWithdrawalLog(userId: string, date: string, drugName: string, symptoms?: string) {\n  ensureUser(userId);\n  const id = uuid();\n  db.prepare(`insert into withdrawal_symptoms(id,user_id,date,drug_name,symptoms) values (?,?,?,?,?)`)\n    .run(id, userId, date, drugName, symptoms ?? null);\n  return { id, userId, date, drugName, symptoms };\n}\n\nexport async function calculateCaloriesWithAI(mealsDescription: string) {\n  console.log('[OpenAI] Starting calorie calculation for:', mealsDescription.substring(0, 100) + '...');\n  \n  if (!process.env.OPENAI_API_KEY) {\n    console.error('[OpenAI] OPENAI_API_KEY is not set!');\n    throw new Error('OpenAI API key is not configured');\n  }\n  \n  const openai = new OpenAI({\n    apiKey: process.env.OPENAI_API_KEY,\n  });\n\n  const prompt = `You are a nutrition expert. Analyze the following meals/beverages and estimate the total calories, protein (g), fat (g), and carbs (g).\n\nMeals/Beverages:\n${mealsDescription}\n\nRespond ONLY with a valid JSON object in this exact format (no markdown, no explanation):\n{\"calories\": number, \"protein\": number, \"fat\": number, \"carbs\": number}`;\n\n  try {\n    console.log('[OpenAI] Sending request to API...');\n    const completion = await openai.chat.completions.create({\n      model: \"gpt-4o-mini\",\n      messages: [{ role: \"user\", content: prompt }],\n      temperature: 0.3,\n    });\n\n    const response = completion.choices[0].message.content.trim();\n    console.log('[OpenAI] Raw response:', response);\n    \n    const data = JSON.parse(response);\n    console.log('[OpenAI] Parsed data:', data);\n    \n    const result = {\n      calories: Math.round(data.calories),\n      protein: Math.round(data.protein),\n      fat: Math.round(data.fat),\n      carbs: Math.round(data.carbs),\n    };\n    \n    console.log('[OpenAI] Returning result:', result);\n    return result;\n  } catch (error) {\n    console.error('[OpenAI] Error during calculation:', error);\n    if (error instanceof Error) {\n      console.error('[OpenAI] Error message:', error.message);\n      console.error('[OpenAI] Error stack:', error.stack);\n    }\n    throw error;\n  }\n}\n\nexport async function getProfile(userId:string){ return { inRecovery: false }; }\n\nexport async function getGoals(userId: string) {\n  ensureUser(userId);\n  const row = db.prepare(`select kcal_goal from goals where user_id = ?`).get(userId) as any;\n  if (!row) return { kcalGoal: 2000 };\n  return { kcalGoal: row.kcal_goal };\n}\n","size_bytes":16212},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/pages/meals.tsx":{"content":"// PBJ Health - Meals Page\nimport { useState } from 'react';\nimport { useAuth } from '@/hooks/useAuth';\nimport { DashboardCard } from '@/components/DashboardCard';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { ArrowLeft } from 'lucide-react';\nimport { Link } from 'wouter';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useToast } from '@/hooks/use-toast';\nimport { getTodayISO } from '@/lib/dateUtils';\n\nexport default function Meals() {\n  const { isAuthenticated } = useAuth();\n  const [calories, setCalories] = useState('');\n  const [protein, setProtein] = useState('');\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const mutation = useMutation({\n    mutationFn: async (data: { date: string; calories: number; proteinG?: number }) => {\n      await apiRequest('POST', '/api/meals', data);\n    },\n    onSuccess: () => {\n      toast({ title: 'Meal logged successfully!' });\n      queryClient.invalidateQueries({ queryKey: ['/api/analytics/daily'] });\n      setCalories('');\n      setProtein('');\n    },\n    onError: (error: Error) => {\n      toast({ title: 'Error', description: error.message, variant: 'destructive' });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    const cal = parseInt(calories);\n    if (isNaN(cal) || cal <= 0) {\n      toast({ title: 'Error', description: 'Please enter valid calories', variant: 'destructive' });\n      return;\n    }\n    mutation.mutate({\n      date: getTodayISO(),\n      calories: cal,\n      proteinG: protein ? parseFloat(protein) : undefined,\n    });\n  };\n\n  if (!isAuthenticated) return null;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b sticky top-0 bg-background/95 backdrop-blur z-50\">\n        <div className=\"max-w-2xl mx-auto px-4 py-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Today\n            </Button>\n          </Link>\n        </div>\n      </header>\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\n        <h1 className=\"text-3xl font-bold mb-8\">Log Meal</h1>\n        <DashboardCard title=\"Add Meal\">\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"calories\">Calories</Label>\n              <Input\n                id=\"calories\"\n                type=\"number\"\n                value={calories}\n                onChange={(e) => setCalories(e.target.value)}\n                placeholder=\"Enter calories\"\n                data-testid=\"input-calories\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"protein\">Protein (g) - Optional</Label>\n              <Input\n                id=\"protein\"\n                type=\"number\"\n                step=\"0.1\"\n                value={protein}\n                onChange={(e) => setProtein(e.target.value)}\n                placeholder=\"Enter protein in grams\"\n                data-testid=\"input-protein\"\n              />\n            </div>\n            <Button type=\"submit\" disabled={mutation.isPending} data-testid=\"button-log-meal\">\n              {mutation.isPending ? 'Logging...' : 'Log Meal'}\n            </Button>\n          </form>\n        </DashboardCard>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3490},"client/src/components/StatusChip.tsx":{"content":"// PBJ Health - Status Chip Component\n// Monospace chips for calories, sleep, gym status\nimport { Badge } from '@/components/ui/badge';\n\ninterface StatusChipProps {\n  type: 'calories' | 'sleep' | 'gym';\n  text: string;\n  testId?: string;\n}\n\nexport function StatusChip({ type, text, testId }: StatusChipProps) {\n  return (\n    <Badge\n      variant=\"secondary\"\n      className=\"font-mono text-sm px-3 py-1 rounded-full\"\n      data-testid={testId || `chip-${type}`}\n    >\n      {text}\n    </Badge>\n  );\n}\n","size_bytes":502},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/pages/workouts.tsx":{"content":"// PBJ Health - Workouts Page\nimport { useState } from 'react';\nimport { useAuth } from '@/hooks/useAuth';\nimport { DashboardCard } from '@/components/DashboardCard';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { ArrowLeft } from 'lucide-react';\nimport { Link } from 'wouter';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useToast } from '@/hooks/use-toast';\nimport { getTodayISO } from '@/lib/dateUtils';\n\nexport default function Workouts() {\n  const { isAuthenticated } = useAuth();\n  const [start, setStart] = useState('');\n  const [end, setEnd] = useState('');\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const mutation = useMutation({\n    mutationFn: async (data: { date: string; startAt: string; endAt: string }) => {\n      await apiRequest('POST', '/api/workouts', data);\n    },\n    onSuccess: () => {\n      toast({ title: 'Workout logged successfully!' });\n      queryClient.invalidateQueries({ queryKey: ['/api/analytics/daily'] });\n      setStart('');\n      setEnd('');\n    },\n    onError: (error: Error) => {\n      toast({ title: 'Error', description: error.message, variant: 'destructive' });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!start || !end) {\n      toast({ title: 'Error', description: 'Please fill in all fields', variant: 'destructive' });\n      return;\n    }\n    mutation.mutate({ date: getTodayISO(), startAt: start, endAt: end });\n  };\n\n  if (!isAuthenticated) return null;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b sticky top-0 bg-background/95 backdrop-blur z-50\">\n        <div className=\"max-w-2xl mx-auto px-4 py-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Today\n            </Button>\n          </Link>\n        </div>\n      </header>\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\n        <h1 className=\"text-3xl font-bold mb-8\">Log Workout</h1>\n        <DashboardCard title=\"Workout Session\">\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"start\">Check In</Label>\n              <Input\n                id=\"start\"\n                type=\"datetime-local\"\n                value={start}\n                onChange={(e) => setStart(e.target.value)}\n                data-testid=\"input-workout-start\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"end\">Check Out</Label>\n              <Input\n                id=\"end\"\n                type=\"datetime-local\"\n                value={end}\n                onChange={(e) => setEnd(e.target.value)}\n                data-testid=\"input-workout-end\"\n              />\n            </div>\n            <Button type=\"submit\" disabled={mutation.isPending} data-testid=\"button-log-workout\">\n              {mutation.isPending ? 'Logging...' : 'Log Workout'}\n            </Button>\n          </form>\n        </DashboardCard>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3242},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"1.25rem\", /* 20px - PBJ default */\n        md: \"0.75rem\", /* 12px - PBJ buttons */\n        sm: \"0.5rem\", /* 8px */\n        xl: \"1.25rem\", /* 20px - PBJ cards */\n        \"2xl\": \"1.25rem\", /* 20px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n        \"streak-green\": {\n          DEFAULT: \"hsl(var(--streak-green) / <alpha-value>)\",\n          foreground: \"hsl(var(--streak-green-foreground) / <alpha-value>)\",\n        },\n        \"streak-yellow\": {\n          DEFAULT: \"hsl(var(--streak-yellow) / <alpha-value>)\",\n          foreground: \"hsl(var(--streak-yellow-foreground) / <alpha-value>)\",\n        },\n        \"streak-red\": {\n          DEFAULT: \"hsl(var(--streak-red) / <alpha-value>)\",\n          foreground: \"hsl(var(--streak-red-foreground) / <alpha-value>)\",\n        },\n        pbj: {\n          purple: \"#AB13E6\",\n          gold: \"#C38452\",\n          ink: \"#0B0C0F\",\n          coal: \"#101217\",\n          slate: \"#1B2027\",\n          mist: \"#E7EBF0\",\n          graphite: \"#8C96A5\",\n          teal: \"#1FE8C6\",\n          coral: \"#FF5A7A\",\n          amber: \"#FFB648\",\n          sky: \"#46A3FF\",\n        },\n      },\n      boxShadow: {\n        pbj: \"0 1px 0 rgba(255,255,255,.03), 0 6px 16px rgba(0,0,0,.35)\",\n        \"pbj-glow-purple\": \"0 0 24px rgba(171,19,230,.25)\",\n        \"pbj-glow-gold\": \"0 0 24px rgba(195,132,82,.22)\",\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":5238},"server/replitAuth.ts":{"content":"// server/replitAuth.ts\nimport * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!,\n    );\n  },\n  { maxAge: 3600 * 1000 },\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const PgStore = connectPg(session);\n  const store = new PgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: true, // <- create if not exists\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store,\n    resave: false,\n    saveUninitialized: false,\n    cookie: { httpOnly: true, secure: true, maxAge: sessionTtl },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified,\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    verified(null, user);\n  };\n\n  const strategies = new Set<string>();\n  const ensureStrategy = (domain: string) => {\n    const name = `replitauth:${domain}`;\n    if (strategies.has(name)) return;\n    passport.use(\n      new Strategy(\n        {\n          name,\n          config,\n          scope: \"openid email profile offline_access\",\n          callbackURL: `https://${domain}/api/callback`,\n        },\n        verify,\n      ),\n    );\n    strategies.add(name);\n  };\n\n  passport.serializeUser((user, cb) => cb(null, user));\n  passport.deserializeUser((user, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/api/login\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", async (req, res) => {\n    const cfg = await getOidcConfig();\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(cfg, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href,\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n  if (!req.isAuthenticated() || !user?.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) return next();\n\n  const refresh = user.refresh_token;\n  if (!refresh) return res.status(401).json({ message: \"Unauthorized\" });\n\n  try {\n    const cfg = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(cfg, refresh);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n};\n","size_bytes":3877},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"server/routes.ts":{"content":"// server/routes.ts\nimport type { Express, Request, Response } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { setupAuth, isAuthenticated } from \"./replitAuth\";\nimport * as storage from \"./storage\";\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Re-enable Replit Auth\n  await setupAuth(app);\n\n  // AUTH\n  app.get(\n    \"/api/auth/user\",\n    isAuthenticated,\n    async (req: any, res: Response) => {\n      try {\n        const claims = req.user?.claims;\n        // Parse name into firstName and lastName\n        const fullName = claims?.name || '';\n        const nameParts = fullName.split(' ');\n        const firstName = nameParts[0] || '';\n        const lastName = nameParts.slice(1).join(' ') || '';\n        \n        res.json({ \n          id: claims?.sub, \n          email: claims?.email, \n          firstName,\n          lastName,\n          profileImageUrl: claims?.profileImage \n        });\n      } catch {\n        res.status(500).json({ message: \"Failed to fetch user\" });\n      }\n    },\n  );\n\n  // SLEEP\n  app.post(\"/api/sleep\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { startAt, endAt } = req.body;\n      if (!startAt || !endAt)\n        return res.status(400).json({ message: \"startAt & endAt required\" });\n      const row = await storage.createSleep(userId, startAt, endAt);\n      res.json(row);\n    } catch (error) {\n      console.error(\"Error creating sleep:\", error);\n      res.status(500).json({ message: \"Failed to create sleep session\" });\n    }\n  });\n\n  app.get(\"/api/sleep/:date\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { date } = req.params;\n      const sessions = await storage.getSleepByDate(userId, date);\n      res.json(sessions);\n    } catch (error) {\n      console.error(\"Error fetching sleep:\", error);\n      res.status(500).json({ message: \"Failed to fetch sleep sessions\" });\n    }\n  });\n\n  // WEIGHT\n  app.post(\"/api/weight\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { date, weightKg } = req.body;\n      if (!date || !weightKg)\n        return res.status(400).json({ message: \"date & weightKg required\" });\n      const row = await storage.createWeight(userId, date, weightKg);\n      res.json(row);\n    } catch (error) {\n      console.error(\"Error creating weight:\", error);\n      res.status(500).json({ message: \"Failed to create weight entry\" });\n    }\n  });\n\n  app.get(\"/api/weight\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const history = await storage.getWeightHistory(userId);\n      res.json(history);\n    } catch (error) {\n      console.error(\"Error fetching weight:\", error);\n      res.status(500).json({ message: \"Failed to fetch weight history\" });\n    }\n  });\n\n  // MEALS\n  app.post(\"/api/meals\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { date, calories, proteinG, fatG, carbsG, notes } = req.body;\n      if (!date || !calories)\n        return res.status(400).json({ message: \"date & calories required\" });\n      const row = await storage.createMeal(userId, date, calories, proteinG, fatG, carbsG, notes);\n      res.json(row);\n    } catch (error) {\n      console.error(\"Error creating meal:\", error);\n      res.status(500).json({ message: \"Failed to create meal\" });\n    }\n  });\n\n  app.get(\"/api/meals/:date\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { date } = req.params;\n      const meals = await storage.getMealsByDate(userId, date);\n      res.json(meals);\n    } catch (error) {\n      console.error(\"Error fetching meals:\", error);\n      res.status(500).json({ message: \"Failed to fetch meals\" });\n    }\n  });\n\n  // WORKOUTS\n  app.post(\"/api/workouts\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { date, startAt, endAt } = req.body;\n      if (!date || !startAt || !endAt)\n        return res.status(400).json({ message: \"date, startAt & endAt required\" });\n      const row = await storage.createWorkout(userId, date, startAt, endAt);\n      res.json(row);\n    } catch (error) {\n      console.error(\"Error creating workout:\", error);\n      res.status(500).json({ message: \"Failed to create workout\" });\n    }\n  });\n\n  app.get(\"/api/workouts/:date\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { date } = req.params;\n      const workouts = await storage.getWorkoutsByDate(userId, date);\n      res.json(workouts);\n    } catch (error) {\n      console.error(\"Error fetching workouts:\", error);\n      res.status(500).json({ message: \"Failed to fetch workouts\" });\n    }\n  });\n\n  // ANALYTICS\n  app.get(\"/api/analytics/daily/:date\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { date } = req.params;\n      const analytics = await storage.getDailyAnalytics(userId, date);\n      res.json(analytics);\n    } catch (error) {\n      console.error(\"Error fetching analytics:\", error);\n      res.status(500).json({ message: \"Failed to fetch analytics\" });\n    }\n  });\n\n  app.get(\"/api/analytics/history/:days\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const days = parseInt(req.params.days) || 7;\n      const history = await storage.getAnalyticsHistory(userId, days);\n      res.json(history);\n    } catch (error) {\n      console.error(\"Error fetching analytics history:\", error);\n      res.status(500).json({ message: \"Failed to fetch analytics history\" });\n    }\n  });\n\n  // STREAKS\n  app.get(\"/api/streaks/current\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const streaks = await storage.getStreaks(userId);\n      res.json(streaks);\n    } catch (error) {\n      console.error(\"Error fetching streaks:\", error);\n      res.status(500).json({ message: \"Failed to fetch streaks\" });\n    }\n  });\n\n  // MENTAL HEALTH\n  app.post(\"/api/mental\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { date, rating, why } = req.body;\n      if (!date || !rating)\n        return res.status(400).json({ message: \"date & rating required\" });\n      const row = await storage.createMentalLog(userId, date, rating, why);\n      res.json(row);\n    } catch (error) {\n      console.error(\"Error creating mental log:\", error);\n      res.status(500).json({ message: \"Failed to create mental log\" });\n    }\n  });\n\n  // MEDITATION\n  app.post(\"/api/meditation\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { date, durationMin } = req.body;\n      if (!date || !durationMin)\n        return res.status(400).json({ message: \"date & durationMin required\" });\n      const row = await storage.createMeditation(userId, date, durationMin);\n      res.json(row);\n    } catch (error) {\n      console.error(\"Error creating meditation session:\", error);\n      res.status(500).json({ message: \"Failed to create meditation session\" });\n    }\n  });\n\n  // HOBBIES\n  app.post(\"/api/hobbies\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { date, activities } = req.body;\n      if (!date || !activities)\n        return res.status(400).json({ message: \"date & activities required\" });\n      // For now, create a hobby session with the activities as notes\n      const row = await storage.createHobbySession(userId, 'default-hobby-id', date, 60);\n      res.json(row);\n    } catch (error) {\n      console.error(\"Error creating hobby log:\", error);\n      res.status(500).json({ message: \"Failed to create hobby log\" });\n    }\n  });\n\n  // SOCIAL\n  app.post(\"/api/social\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { date, activity } = req.body;\n      if (!date || !activity)\n        return res.status(400).json({ message: \"date & activity required\" });\n      const row = await storage.createSocialLog(userId, date, activity);\n      res.json(row);\n    } catch (error) {\n      console.error(\"Error creating social log:\", error);\n      res.status(500).json({ message: \"Failed to create social log\" });\n    }\n  });\n\n  // RECOVERY\n  app.post(\"/api/recovery/drug-use\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { date, drugName, amount, isPrescribed } = req.body;\n      if (!date || !drugName)\n        return res.status(400).json({ message: \"date and drugName required\" });\n      const row = await storage.createDrugUseLog(userId, date, drugName, amount, isPrescribed);\n      res.json(row);\n    } catch (error) {\n      console.error(\"Error creating drug use log:\", error);\n      res.status(500).json({ message: \"Failed to create drug use log\" });\n    }\n  });\n\n  app.post(\"/api/recovery/withdrawal\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const { date, drugName, symptoms } = req.body;\n      if (!date || !drugName)\n        return res.status(400).json({ message: \"date and drugName required\" });\n      const row = await storage.createWithdrawalLog(userId, date, drugName, symptoms);\n      res.json(row);\n    } catch (error) {\n      console.error(\"Error creating withdrawal log:\", error);\n      res.status(500).json({ message: \"Failed to create withdrawal log\" });\n    }\n  });\n  \n  // CALORIE CALCULATION\n  app.post(\"/api/calculate-calories\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const { mealsDescription } = req.body;\n      if (!mealsDescription)\n        return res.status(400).json({ message: \"mealsDescription required\" });\n      \n      const result = await storage.calculateCaloriesWithAI(mealsDescription);\n      res.json(result);\n    } catch (error) {\n      console.error(\"Error calculating calories:\", error);\n      res.status(500).json({ message: \"Failed to calculate calories\" });\n    }\n  });\n\n  // PROFILE\n  app.get(\"/api/profile\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const profile = await storage.getProfile(userId);\n      res.json(profile || { inRecovery: false });\n    } catch (error) {\n      console.error(\"Error fetching profile:\", error);\n      res.status(500).json({ message: \"Failed to fetch profile\" });\n    }\n  });\n  \n  // GOALS\n  app.get(\"/api/goals\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const goals = await storage.getGoals(userId);\n      res.json(goals || { kcalGoal: 2000 });\n    } catch (error) {\n      console.error(\"Error fetching goals:\", error);\n      res.status(500).json({ message: \"Failed to fetch goals\" });\n    }\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","size_bytes":11279},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/pages/placeholder.tsx":{"content":"// PBJ Health - Placeholder Page for remaining features\nimport { useAuth } from '@/hooks/useAuth';\nimport { Button } from '@/components/ui/button';\nimport { ArrowLeft } from 'lucide-react';\nimport { Link } from 'wouter';\n\nexport default function Placeholder({ title }: { title: string }) {\n  const { isAuthenticated } = useAuth();\n\n  if (!isAuthenticated) return null;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b sticky top-0 bg-background/95 backdrop-blur z-50\">\n        <div className=\"max-w-2xl mx-auto px-4 py-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Today\n            </Button>\n          </Link>\n        </div>\n      </header>\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\n        <h1 className=\"text-3xl font-bold mb-4\">{title}</h1>\n        <p className=\"text-muted-foreground\">\n          This feature is coming soon in the next phase of development.\n        </p>\n      </div>\n    </div>\n  );\n}\n","size_bytes":1069},"replit.md":{"content":"# PBJ Health\n\n## Overview\n\nPBJ Health is a comprehensive health tracking application designed to help users achieve sustainable fat loss through daily logging of sleep, nutrition, weight, exercise, and mental health metrics. The application follows a \"one simple daily flow\" philosophy, making it effortless to track multiple health dimensions while building streaks and maintaining consistency.\n\nThe platform combines fitness tracking (inspired by Apple Health and Strava) with gamification elements (inspired by Duolingo) to encourage long-term adherence. Core features include trend weight calculation using EWMA (Exponential Weighted Moving Average), daily analytics, and lifestyle tracking beyond just physical health.\n\n**Primary Goal**: Achieve 4-week trend weight decrease while maintaining ≥80% adherence to health goals.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework**: React with TypeScript, using Vite as the build tool and bundler.\n\n**UI Library**: shadcn/ui components built on Radix UI primitives, providing accessible, customizable components following the \"New York\" style variant. The design system emphasizes:\n- Card-based layouts for scannable information hierarchy\n- Clean, health-focused data presentation\n- Gamification through streak badges and visual rewards\n- Dark-first UI with PBJ Studios brand colors (Purple #AB13E6, Gold #C38452)\n\n**Styling**: Tailwind CSS with custom design tokens and an 8pt spacing grid. The system supports both light and dark themes with CSS custom properties for dynamic theming.\n\n**State Management**: \n- **Zustand** for client-side global state (planned slices for user, goals, diary, steps, workouts, mental health, lifestyle)\n- **React Query (@tanstack/react-query)** for server state management, caching, and data synchronization\n\n**Routing**: wouter for lightweight client-side routing with dedicated pages for each tracking category (Today dashboard, Sleep, Weight, Meals, Workouts, Mental Health, Meditation, Dreams, Work, Social, Hobbies, Recovery).\n\n**Design System**: Typography uses Inter for UI elements and JetBrains Mono for numeric data. Border radius defaults to 20px for cards, 12px for buttons. Component hierarchy emphasizes clarity over decoration with hero numbers (48px), card headers (20px), and body text (16px).\n\n### Backend Architecture\n\n**Runtime**: Node.js with Express.js server handling API routes and serving the React SPA.\n\n**Language**: TypeScript throughout the stack with strict type checking enabled.\n\n**API Design**: RESTful endpoints organized by domain:\n- `/api/auth/*` - Authentication and user management\n- `/api/sleep` - Sleep session tracking\n- `/api/weight` - Body weight logging\n- `/api/meals` - Nutrition and calorie tracking\n- `/api/workouts` - Exercise session logging\n- `/api/mental` - Mental health ratings\n- `/api/meditation` - Meditation session tracking\n- `/api/dreams` - Dream journal entries\n- `/api/work` - Work stress logging\n- `/api/social` - Social activity tracking\n- `/api/analytics/daily` - Daily aggregated metrics\n\n**Authentication**: Replit Auth integration using OpenID Connect (OIDC) with Passport.js strategy. Session management via express-session with PostgreSQL session store (connect-pg-simple). Sessions persist for 7 days with httpOnly, secure cookies.\n\n**Session Storage**: PostgreSQL-backed sessions table ensuring sessions survive server restarts and support horizontal scaling.\n\n### Data Storage\n\n**Database**: PostgreSQL accessed via Neon serverless driver (@neondatabase/serverless) with WebSocket support for serverless environments.\n\n**ORM**: Drizzle ORM for type-safe database queries and schema management. Schema defined in TypeScript with automatic type inference.\n\n**Schema Design**:\n- **users**: Core user profile (id, email, name, profile image)\n- **sessions**: Session persistence for authentication\n- **sleepSessions**: Sleep tracking with start/end timestamps\n- **bodyMetrics**: Weight and body measurements by date\n- **meals**: Calorie and protein intake logs\n- **workouts**: Exercise sessions with duration\n- **mentalLogs**: Daily mental health ratings (great/ok/bad) with notes\n- **meditationSessions**: Meditation practice tracking\n- **dreamEntries**: Dream journal with narrative text\n- **workLogs**: Work stress levels (low/medium/high)\n- **socialLogs**: Social activity tracking\n- **hobbies**: User-defined hobby tracking\n- **hobbySessions**: Time spent on hobbies\n- **drugProfiles**: Substance tracking for recovery\n- **drugUseLogs**: Usage logs for recovery monitoring\n- **goals**: User fitness goals (target weight, calorie targets, step goals)\n- **analyticsDaily**: Daily aggregated metrics and streaks\n\nAll tables use user ID foreign keys with appropriate indexes for query performance.\n\n### External Dependencies\n\n**UI Components**: \n- Radix UI (@radix-ui/*) - Headless accessible component primitives for dialogs, popovers, dropdowns, accordions, etc.\n- Lucide React (lucide-react) - Icon library\n- cmdk - Command palette component\n\n**Utilities**:\n- clsx & tailwind-merge - Conditional className handling\n- class-variance-authority - Type-safe component variants\n- Luxon - Date/time manipulation with timezone support\n- date-fns - Additional date utilities\n- nanoid - Unique ID generation\n\n**Forms & Validation**:\n- React Hook Form - Form state management\n- Zod - Schema validation\n- @hookform/resolvers - Zod integration with React Hook Form\n\n**Authentication**:\n- openid-client - OpenID Connect client\n- passport - Authentication middleware\n- express-session - Session management\n- connect-pg-simple - PostgreSQL session store\n\n**Build & Development**:\n- Vite - Frontend build tool and dev server\n- esbuild - Backend bundling for production\n- tsx - TypeScript execution for development\n- @replit/* plugins - Replit-specific development tooling\n\n**Database**:\n- @neondatabase/serverless - Neon PostgreSQL driver\n- drizzle-orm - TypeScript ORM\n- drizzle-kit - Schema migrations and push\n- ws - WebSocket support for Neon\n\n**Planned Integrations** (referenced in documentation):\n- iOS HealthKit / Android Health Connect - Native health data bridges\n- expo-notifications - Push and local notifications (React Native)\n- Supabase Edge Functions - Background jobs and analytics (future migration from current PostgreSQL setup)\n\n**Note**: The codebase references React Native (Expo) in documentation files, but the current implementation is a web application using React. The Native implementation appears to be a planned future phase.","size_bytes":6589},"client/src/lib/calcs/index.ts":{"content":"// PBJ Health - Calculations Library\n// BMR, TDEE, EWMA, Epley 1RM, etc.\n\nexport interface PersonData {\n  weightKg: number;\n  heightCm: number;\n  age: number;\n  gender: 'male' | 'female';\n}\n\n/**\n * BMR using Mifflin-St Jeor equation\n * Male: 10 * kg + 6.25 * cm - 5 * age + 5\n * Female: 10 * kg + 6.25 * cm - 5 * age - 161\n */\nexport function calculateBMR(data: PersonData): number {\n  const base = 10 * data.weightKg + 6.25 * data.heightCm - 5 * data.age;\n  return data.gender === 'male' ? base + 5 : base - 161;\n}\n\n/**\n * TDEE (Total Daily Energy Expenditure)\n * BMR × activity factor (1.2-1.6)\n */\nexport function calculateTDEE(bmr: number, activityFactor: number): number {\n  return Math.round(bmr * activityFactor);\n}\n\n/**\n * Adaptive TDEE based on actual weight change\n * TDEE_est = AvgIntake + 3500 × (Δ trend_weight / 7 days)\n */\nexport function calculateAdaptiveTDEE(\n  avgIntake: number,\n  trendWeightDeltaKg: number,\n  days: number = 7\n): number {\n  const lbChange = trendWeightDeltaKg * 2.20462; // kg to lbs\n  return Math.round(avgIntake + 3500 * (lbChange / days));\n}\n\n/**\n * Trend Weight using EWMA (Exponentially Weighted Moving Average)\n * λ = 0.25\n */\nexport function calculateTrendWeight(\n  currentTrend: number,\n  newWeight: number,\n  lambda: number = 0.25\n): number {\n  return lambda * newWeight + (1 - lambda) * currentTrend;\n}\n\n/**\n * Simple moving average fallback for trend weight\n */\nexport function calculateMovingAverage(weights: number[]): number {\n  if (weights.length === 0) return 0;\n  return weights.reduce((sum, w) => sum + w, 0) / weights.length;\n}\n\n/**\n * Epley 1RM formula\n * 1RM = weight × (1 + reps / 30)\n */\nexport function calculateOneRepMax(weight: number, reps: number): number {\n  return Math.round(weight * (1 + reps / 30) * 10) / 10;\n}\n\n/**\n * Auto progression logic\n * RIR ≤ 2 → +2.5-5 lb next time\n * RIR ≥ 4 → hold or reduce\n */\nexport function suggestProgression(\n  currentWeight: number,\n  lastSetRIR: number\n): { weight: number; action: 'increase' | 'maintain' | 'reduce' } {\n  if (lastSetRIR <= 2) {\n    // Add 2.5-5 lb (1-2.5 kg)\n    const increment = currentWeight < 50 ? 1 : 2.5;\n    return { weight: currentWeight + increment, action: 'increase' };\n  } else if (lastSetRIR >= 4) {\n    return { weight: currentWeight, action: 'maintain' };\n  }\n  return { weight: currentWeight, action: 'maintain' };\n}\n\n/**\n * Plateau detection\n * 14 days with ≤ 0.3% body weight change AND adherence ≥ 80%\n */\nexport function detectPlateau(\n  weightChange: number,\n  bodyWeight: number,\n  days: number,\n  adherence: number\n): boolean {\n  if (days < 14 || adherence < 0.8) return false;\n  const percentChange = Math.abs(weightChange / bodyWeight);\n  return percentChange <= 0.003; // 0.3%\n}\n\n/**\n * Calculate calorie deficit for weight loss goal\n * 1 lb fat = ~3500 kcal\n */\nexport function calculateDeficit(\n  currentWeightKg: number,\n  goalWeightKg: number,\n  weeksToGoal: number,\n  tdee: number\n): { dailyDeficit: number; targetKcal: number } {\n  const totalLbToLose = (currentWeightKg - goalWeightKg) * 2.20462;\n  const totalDeficitNeeded = totalLbToLose * 3500;\n  const dailyDeficit = Math.round(totalDeficitNeeded / (weeksToGoal * 7));\n  const targetKcal = tdee - dailyDeficit;\n  \n  return { dailyDeficit, targetKcal };\n}\n\n/**\n * Format duration from minutes to h:mm\n */\nexport function formatDuration(minutes: number): string {\n  const h = Math.floor(minutes / 60);\n  const m = minutes % 60;\n  return `${h}h${String(m).padStart(2, '0')}m`;\n}\n\n/**\n * Parse duration string to minutes\n */\nexport function parseDuration(duration: string): number {\n  const match = duration.match(/(\\d+)h(\\d+)m?/);\n  if (!match) return 0;\n  return parseInt(match[1]) * 60 + parseInt(match[2]);\n}\n","size_bytes":3738},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"client/src/lib/dateUtils.ts":{"content":"// Date utilities for PBJ Health\nimport { DateTime } from 'luxon';\n\nexport function getTodayISO(tz: string = 'America/New_York'): string {\n  return DateTime.now().setZone(tz).toISODate() || '';\n}\n\nexport function getYesterdayISO(tz: string = 'America/New_York'): string {\n  return DateTime.now().setZone(tz).minus({ days: 1 }).toISODate() || '';\n}\n\nexport function formatDate(dateStr: string, tz: string = 'America/New_York'): string {\n  const dt = DateTime.fromISO(dateStr).setZone(tz);\n  return dt.toFormat('MMM d, yyyy');\n}\n\nexport function formatTime(timestamp: string, tz: string = 'America/New_York'): string {\n  const dt = DateTime.fromISO(timestamp).setZone(tz);\n  return dt.toFormat('h:mm a');\n}\n\nexport function formatDateTime(timestamp: string, tz: string = 'America/New_York'): string {\n  const dt = DateTime.fromISO(timestamp).setZone(tz);\n  return dt.toFormat('MMM d, h:mm a');\n}\n\nexport function getDateRange(days: number, tz: string = 'America/New_York'): string[] {\n  const today = DateTime.now().setZone(tz);\n  const dates: string[] = [];\n  \n  for (let i = days - 1; i >= 0; i--) {\n    dates.push(today.minus({ days: i }).toISODate() || '');\n  }\n  \n  return dates;\n}\n","size_bytes":1185},"design_guidelines.md":{"content":"# PBJ Health - Design Guidelines\n\n## Design Approach\n\n**Selected Approach**: Design System with Gamification Elements\n\nDrawing inspiration from established health and productivity apps:\n- **Primary Reference**: Apple Health for clean data presentation and card layouts\n- **Gamification**: Duolingo for streak visualization and achievement patterns\n- **Fitness Tracking**: Strava for workout displays and progress charts\n- **Organization**: Notion for card-based information architecture\n\n**Core Principles**:\n1. Clarity over decoration - health data must be instantly readable\n2. Encouraging progression - visual rewards for consistency\n3. Effortless input - minimize friction for daily logging\n4. Scannable hierarchy - users track multiple metrics simultaneously\n\n---\n\n## Typography\n\n**Font Stack**: System fonts via Google Fonts\n- **Primary**: Inter (headings, UI elements, data displays)\n- **Monospace**: JetBrains Mono (numeric data, time stamps, calories)\n\n**Type Scale**:\n- **Hero Numbers**: 48px/56px bold (trend weight, streak counts)\n- **Card Headers**: 20px/24px semibold (section titles)\n- **Body Text**: 16px/24px regular (descriptions, form labels)\n- **Data Labels**: 14px/20px medium (metric labels, timestamps)\n- **Chips/Badges**: 12px/16px semibold (status indicators, streak badges)\n\n**Weight Distribution**:\n- Regular (400): body text, descriptions\n- Medium (500): labels, secondary headings\n- Semibold (600): card titles, CTAs\n- Bold (700): hero numbers, streak counts\n\n---\n\n## Layout System\n\n**Spacing Primitives**: Tailwind units of 2, 4, 6, and 8\n- **Micro spacing**: p-2, gap-2 (chip internal padding, icon spacing)\n- **Standard spacing**: p-4, gap-4 (card padding, form field gaps)\n- **Section spacing**: p-6, gap-6 (between card sections)\n- **Major separation**: p-8, gap-8 (page margins, dashboard card gaps)\n\n**Container Strategy**:\n- **Dashboard**: max-w-6xl centered with px-4 for mobile breathing room\n- **Forms**: max-w-2xl for optimal input efficiency\n- **Charts/Reports**: max-w-7xl for data visualization\n\n**Grid Patterns**:\n- **Dashboard Cards**: Single column on mobile, 2-column grid (md:grid-cols-2) on tablet+\n- **Metric Chips**: Flex wrap for dynamic badge rows\n- **Workout Exercises**: Single column list with expandable details\n\n---\n\n## Component Library\n\n### Dashboard Cards\n**Structure**: Rounded corners (rounded-xl), shadow (shadow-md), internal padding (p-6)\n- **Header**: Title + action button/link in flex justify-between\n- **Content**: Metric display or status chips\n- **Footer**: Timestamp or navigation link (text-sm)\n\n### Streak Badges\n**Visual System**:\n- **Green (3/3)**: Solid fill, white text, check icon\n- **Yellow (2/3)**: Solid fill, dark text, caution icon\n- **Red (0-1/3)**: Solid fill, white text, x icon\n- **Format**: Circular badges (h-12 w-12) with centered icons, inline labels\n\n### Status Chips\n**Calorie Chip**: `2000/1700 OV +300`\n- Monospace font, inline badge with status indicator (OV/UN/GOAL)\n- Compact (px-3 py-1 rounded-full)\n\n**Sleep Chip**: `6h45m ✅`\n- Monospace time + emoji indicator\n- Same compact styling\n\n**Gym Chip**: `✅ 1h12m (6:10–7:22)`\n- Duration prominent, timestamps smaller (text-sm)\n\n### Form Elements\n**Input Fields**:\n- Large touch targets (min-h-12)\n- Clear labels (mb-2 font-medium)\n- Inline validation feedback below inputs\n- Number inputs with +/- steppers for quick adjustments\n\n**Quick Add Patterns**:\n- Favorite items as tappable pills (rounded-full px-4 py-2)\n- Recent entries dropdown for meal/exercise reuse\n- Swipe gestures for deleting log entries\n\n### Charts (Victory Native)\n**Style Consistency**:\n- Line charts for trends (weight, sleep, calories over time)\n- Bar charts for daily comparisons (workout volume, step counts)\n- Minimal gridlines, emphasized data points\n- Contextual annotations (goals, averages as dashed lines)\n\n### Navigation\n**Tab Bar**: Fixed bottom navigation with 5 primary tabs\n- Icons above labels, active state with accent indicator\n- Tab labels: Today, Trends, Log, Lyfe, Profile\n\n**Stack Navigation**: Simple header with back arrow, centered title, optional action\n\n### Modal Patterns\n**Morning Prompts**: Full-screen sequential flow\n- One question per screen with large response buttons\n- Progress indicator (dots or step counter)\n- Skip option always visible\n\n**Lyfe Reports**: Modal overlay with close X\n- Report type selector (Day/7/30/90) as segmented control\n- Scrollable content with section dividers\n\n---\n\n## Images\n\n**Dashboard Today Screen**: \n- Hero spot at top (before cards) showing motivational image relevant to user's primary goal (fitness, weight loss, wellness)\n- Size: Full width, 200px height on mobile, 280px on desktop\n- Treatment: Subtle gradient overlay for text readability\n\n**Empty States**:\n- Illustration for \"No workouts logged yet\" - friendly character doing exercise\n- Illustration for \"No dreams recorded\" - peaceful sleeping figure\n- Illustration for \"Start your streak\" - path/journey visual\n\n**Achievement Celebrations**:\n- Milestone images for streak milestones (7, 30, 90 days)\n- Recovery clean-day celebrations with encouraging imagery\n\n**Workout Library**:\n- Exercise demonstration images (optional, use placeholders if not available)\n- Small thumbnails (80x80) in exercise picker\n\n---\n\n## Animations\n\n**Minimal Approach** - only where providing valuable feedback:\n- **Streak Badge Updates**: Brief scale bounce (0.95→1.05→1) on daily check completion\n- **Chart Data Entry**: Smooth line drawing for trend weight updates\n- **Form Validation**: Shake animation for errors (translate-x-2 keyframes)\n- **NO**: Page transitions, hover effects, decorative motions\n\n---\n\n## Accessibility & Interaction\n\n**Touch Targets**: Minimum 44px height for all interactive elements\n**Focus States**: 2px outline offset for keyboard navigation\n**Labels**: All inputs have visible labels, not just placeholders\n**Contrast**: WCAG AA minimum for all text (4.5:1 normal, 3:1 large)\n**Status Indicators**: Never rely on visual treatment alone - always include text/icon\n\n---\n\n## Dark/Light Mode Strategy\n\nImplementation uses CSS variables for seamless switching:\n- Cards maintain elevation through border treatments in dark mode\n- Charts use mode-appropriate palettes (muted in dark, vibrant in light)\n- Streak badges maintain their semantic meaning (green stays encouraging, red stays warning)","size_bytes":6355},"client/src/App.tsx":{"content":"// PBJ Health - Main App\n// Reference: Replit Auth blueprint for routing\nimport { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport NotFound from \"@/pages/not-found\";\nimport Landing from \"@/pages/landing\";\nimport Today from \"@/pages/today\";\nimport Sleep from \"@/pages/sleep\";\nimport Weight from \"@/pages/weight\";\nimport Meals from \"@/pages/meals\";\nimport Workouts from \"@/pages/workouts\";\nimport Mental from \"@/pages/mental\";\nimport Meditation from \"@/pages/meditation\";\nimport Dreams from \"@/pages/dreams\";\nimport Work from \"@/pages/work\";\nimport Social from \"@/pages/social\";\nimport Hobbies from \"@/pages/hobbies\";\nimport Recovery from \"@/pages/recovery\";\nimport Profile from \"@/pages/profile\";\nimport Placeholder from \"@/pages/placeholder\";\n\nfunction Router() {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  // Show loading state\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-pulse text-muted-foreground\">Loading...</div>\n      </div>\n    );\n  }\n\n  // Unauthenticated routes\n  if (!isAuthenticated) {\n    return (\n      <Switch>\n        <Route path=\"/\" component={Landing} />\n        <Route>\n          {() => {\n            // Redirect any protected route to login\n            window.location.href = '/api/login';\n            return null;\n          }}\n        </Route>\n      </Switch>\n    );\n  }\n\n  // Authenticated routes\n  return (\n    <Switch>\n      <Route path=\"/\" component={Today} />\n      <Route path=\"/sleep\" component={Sleep} />\n      <Route path=\"/weight\" component={Weight} />\n      <Route path=\"/meals\" component={Meals} />\n      <Route path=\"/workouts\" component={Workouts} />\n      <Route path=\"/mental\" component={Mental} />\n      <Route path=\"/meditation\" component={Meditation} />\n      <Route path=\"/dreams\" component={Dreams} />\n      <Route path=\"/work\" component={Work} />\n      <Route path=\"/social\" component={Social} />\n      <Route path=\"/hobbies\" component={Hobbies} />\n      <Route path=\"/recovery\" component={Recovery} />\n      <Route path=\"/profile\" component={Profile} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Toaster />\n        <Router />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":2629},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"shared/schema.ts":{"content":"// PBJ Health - Complete Database Schema\n// Reference: Replit Auth + PostgreSQL blueprints\nimport { sql } from 'drizzle-orm';\nimport { relations } from 'drizzle-orm';\nimport {\n  pgTable,\n  varchar,\n  text,\n  timestamp,\n  index,\n  jsonb,\n  date,\n  integer,\n  numeric,\n  boolean,\n  uuid,\n  check,\n} from 'drizzle-orm/pg-core';\nimport { createInsertSchema } from 'drizzle-zod';\nimport { z } from 'zod';\n\n// ============================================================================\n// SESSION & AUTH (Required for Replit Auth)\n// ============================================================================\n\nexport const sessions = pgTable(\n  'sessions',\n  {\n    sid: varchar('sid').primaryKey(),\n    sess: jsonb('sess').notNull(),\n    expire: timestamp('expire').notNull(),\n  },\n  (table) => [index('IDX_session_expire').on(table.expire)]\n);\n\nexport const users = pgTable('users', {\n  id: varchar('id').primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar('email').unique(),\n  firstName: varchar('first_name'),\n  lastName: varchar('last_name'),\n  profileImageUrl: varchar('profile_image_url'),\n  createdAt: timestamp('created_at').defaultNow(),\n  updatedAt: timestamp('updated_at').defaultNow(),\n});\n\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\n\n// ============================================================================\n// USER PROFILE & GOALS\n// ============================================================================\n\nexport const profiles = pgTable('profiles', {\n  userId: varchar('user_id').primaryKey().references(() => users.id, { onDelete: 'cascade' }),\n  age: integer('age'),\n  gender: varchar('gender', { length: 10 }),\n  heightCm: numeric('height_cm', { precision: 5, scale: 2 }),\n  activityFactor: numeric('activity_factor', { precision: 3, scale: 2 }).default('1.2'),\n  timezone: varchar('timezone', { length: 50 }).default('America/New_York'),\n  inRecovery: boolean('in_recovery').default(false),\n  profileJson: jsonb('profile_json').default({}).notNull(),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n});\n\nexport const goals = pgTable('goals', {\n  userId: varchar('user_id').primaryKey().references(() => users.id, { onDelete: 'cascade' }),\n  goalWeightKg: numeric('goal_weight_kg', { precision: 6, scale: 2 }),\n  paceLbPerWeek: numeric('pace_lb_per_week', { precision: 4, scale: 2 }),\n  stepGoal: integer('step_goal').default(10000),\n  kcalGoal: integer('kcal_goal').default(2000),\n  kcalFloor: integer('kcal_floor').default(1500),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\n// ============================================================================\n// SLEEP TRACKING\n// ============================================================================\n\nexport const sleepSessions = pgTable('sleep_sessions', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  startAt: timestamp('start_at', { withTimezone: true }).notNull(),\n  endAt: timestamp('end_at', { withTimezone: true }).notNull(),\n  quality: integer('quality'),\n  dreamType: text('dream_type'),\n  dreamDescription: text('dream_description'),\n  notes: text('notes'),\n}, (table) => [\n  check('sleep_dream_type_check', sql`dream_type IN ('dream', 'nightmare', 'none') OR dream_type IS NULL`),\n]);\n\n// ============================================================================\n// BODY METRICS (Weight, Body Composition)\n// ============================================================================\n\nexport const bodyMetrics = pgTable('body_metrics', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  date: date('date').notNull(),\n  weightKg: numeric('weight_kg', { precision: 6, scale: 2 }).notNull(),\n  bodyFatPct: numeric('body_fat_pct', { precision: 5, scale: 2 }),\n  muscleKg: numeric('muscle_kg', { precision: 6, scale: 2 }),\n  waterPct: numeric('water_pct', { precision: 5, scale: 2 }),\n  visceralFat: numeric('visceral_fat', { precision: 5, scale: 2 }),\n  source: text('source'),\n  rawJson: jsonb('raw_json'),\n}, (table) => [\n  index('body_metrics_user_date_idx').on(table.userId, table.date),\n]);\n\n// ============================================================================\n// STEPS TRACKING\n// ============================================================================\n\nexport const steps = pgTable('steps', {\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  date: date('date').notNull(),\n  steps: integer('steps').notNull().default(0),\n  activeMinutes: integer('active_minutes'),\n  source: text('source'),\n}, (table) => [\n  index('steps_user_date_idx').on(table.userId, table.date),\n]);\n\n// ============================================================================\n// NUTRITION TRACKING\n// ============================================================================\n\nexport const meals = pgTable('meals', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  date: date('date').notNull(),\n  mealType: text('meal_type'),\n  calories: integer('calories').notNull(),\n  proteinG: numeric('protein_g', { precision: 6, scale: 2 }),\n  carbsG: numeric('carbs_g', { precision: 6, scale: 2 }),\n  fatG: numeric('fat_g', { precision: 6, scale: 2 }),\n  notes: text('notes'),\n}, (table) => [\n  index('meals_user_date_idx').on(table.userId, table.date),\n]);\n\n// ============================================================================\n// WORKOUT TRACKING\n// ============================================================================\n\nexport const workouts = pgTable('workouts', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  date: date('date').notNull(),\n  templateId: text('template_id'),\n  rpe: numeric('rpe', { precision: 4, scale: 2 }),\n  exercises: text('exercises').array(),\n  notes: text('notes'),\n  durationMin: integer('duration_min'),\n  startAt: timestamp('start_at', { withTimezone: true }),\n  endAt: timestamp('end_at', { withTimezone: true }),\n}, (table) => [\n  index('workouts_user_date_idx').on(table.userId, table.date),\n]);\n\nexport const exercises = pgTable('exercises', {\n  id: text('id').primaryKey(),\n  name: text('name').notNull(),\n  equipment: text('equipment'),\n  primaryMuscle: text('primary_muscle'),\n  smithFriendlyBool: boolean('smith_friendly_bool').default(false),\n});\n\nexport const workoutSets = pgTable('workout_sets', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  workoutId: uuid('workout_id').references(() => workouts.id, { onDelete: 'cascade' }).notNull(),\n  exerciseId: text('exercise_id').references(() => exercises.id),\n  setNo: integer('set_no'),\n  weightKg: numeric('weight_kg', { precision: 6, scale: 2 }),\n  reps: integer('reps'),\n  rir: integer('rir'),\n});\n\n// ============================================================================\n// MENTAL HEALTH & DREAMS\n// ============================================================================\n\nexport const mentalLogs = pgTable('mental_logs', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  date: date('date').notNull(),\n  rating: text('rating').notNull(),\n  why: text('why'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n}, (table) => [\n  check('mental_rating_check', sql`rating IN ('great', 'ok', 'bad')`),\n  index('mental_logs_user_date_idx').on(table.userId, table.date),\n]);\n\nexport const dreamEntries = pgTable('dream_entries', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  date: date('date').notNull(),\n  title: text('title'),\n  narrative: text('narrative'),\n  tags: text('tags').array(),\n  emotion: integer('emotion'),\n  intensity: integer('intensity'),\n  aiSummary: text('ai_summary'),\n  aiThemes: text('ai_themes').array(),\n  aiAdvice: text('ai_advice'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n}, (table) => [\n  check('dream_emotion_check', sql`emotion >= 1 AND emotion <= 5`),\n  check('dream_intensity_check', sql`intensity >= 1 AND intensity <= 5`),\n  index('dream_entries_user_date_idx').on(table.userId, table.date),\n]);\n\n// ============================================================================\n// WORK & STRESS\n// ============================================================================\n\nexport const workLogs = pgTable('work_logs', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  date: date('date').notNull(),\n  startAt: timestamp('start_at', { withTimezone: true }),\n  endAt: timestamp('end_at', { withTimezone: true }),\n  stress: text('stress'),\n}, (table) => [\n  check('work_stress_check', sql`stress IN ('low', 'medium', 'high')`),\n  index('work_logs_user_date_idx').on(table.userId, table.date),\n]);\n\n// ============================================================================\n// MEDITATION\n// ============================================================================\n\nexport const meditationSessions = pgTable('meditation_sessions', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  date: date('date').notNull(),\n  durationMin: integer('duration_min').notNull(),\n  feeling: text('feeling'),\n  startedAt: timestamp('started_at').defaultNow(),\n}, (table) => [\n  check('meditation_feeling_check', sql`feeling IN ('calm', 'neutral', 'restless')`),\n  index('meditation_sessions_user_date_idx').on(table.userId, table.date),\n]);\n\n// ============================================================================\n// HOBBIES & SOCIAL\n// ============================================================================\n\nexport const hobbies = pgTable('hobbies', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  name: text('name').notNull(),\n  primaryHobby: boolean('primary_hobby').notNull().default(false),\n});\n\nexport const hobbySessions = pgTable('hobby_sessions', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  hobbyId: uuid('hobby_id').references(() => hobbies.id, { onDelete: 'cascade' }),\n  date: date('date').notNull(),\n  startAt: timestamp('start_at', { withTimezone: true }),\n  endAt: timestamp('end_at', { withTimezone: true }),\n  durationMin: integer('duration_min'),\n}, (table) => [\n  index('hobby_sessions_user_date_idx').on(table.userId, table.date),\n]);\n\nexport const socialLogs = pgTable('social_logs', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  date: date('date').notNull(),\n  activity: text('activity').notNull(),\n  durationMin: integer('duration_min').default(0),\n}, (table) => [\n  index('social_logs_user_date_idx').on(table.userId, table.date),\n]);\n\n// ============================================================================\n// DRUGS & RECOVERY\n// ============================================================================\n\nexport const drugProfiles = pgTable('drug_profiles', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  name: text('name').notNull(),\n  type: text('type'),\n  inRecovery: boolean('in_recovery').notNull().default(false),\n  cleanSince: date('clean_since'),\n  goal: text('goal'),\n});\n\nexport const drugUseLogs = pgTable('drug_use_logs', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  date: date('date').notNull(),\n  drugId: uuid('drug_id').references(() => drugProfiles.id, { onDelete: 'cascade' }),\n  drugName: text('drug_name').notNull(),\n  amount: text('amount'),\n  isPrescribed: boolean('is_prescribed').default(false).notNull(),\n  notes: text('notes'),\n}, (table) => [\n  index('drug_use_logs_user_date_idx').on(table.userId, table.date),\n]);\n\nexport const withdrawalSymptoms = pgTable('withdrawal_symptoms', {\n  id: uuid('id').primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  date: date('date').notNull(),\n  drugId: uuid('drug_id').references(() => drugProfiles.id, { onDelete: 'cascade' }),\n  drugName: text('drug_name').notNull(),\n  symptoms: text('symptoms'),\n  symptom: text('symptom'),\n  strength: text('strength'),\n}, (table) => [\n  check('withdrawal_strength_check', sql`strength IN ('low', 'medium', 'high')`),\n  index('withdrawal_symptoms_user_date_idx').on(table.userId, table.date),\n]);\n\n// ============================================================================\n// ANALYTICS (Daily & Weekly)\n// ============================================================================\n\nexport const analyticsDaily = pgTable('analytics_daily', {\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  date: date('date').notNull(),\n  sleepMin: integer('sleep_min').notNull().default(0),\n  sleepOk: boolean('sleep_ok').notNull().default(false),\n  kcalIntake: integer('kcal_intake').notNull().default(0),\n  kcalGoal: integer('kcal_goal').notNull().default(0),\n  kcalDelta: integer('kcal_delta').notNull().default(0),\n  kcalOk: boolean('kcal_ok').notNull().default(false),\n  kcalStatus: text('kcal_status').notNull().default('GOAL'),\n  gymOk: boolean('gym_ok').notNull().default(false),\n  gymStartAt: timestamp('gym_start_at', { withTimezone: true }),\n  gymEndAt: timestamp('gym_end_at', { withTimezone: true }),\n  gymDurationMin: integer('gym_duration_min').notNull().default(0),\n  scoreSmall: integer('score_small').notNull().default(0),\n  color: text('color').notNull().default('red'),\n  mentalRating: text('mental_rating'),\n  mentalWhy: text('mental_why'),\n  dreamCount: integer('dream_count').default(0),\n  meditationMin: integer('meditation_min').default(0),\n  workMin: integer('work_min').default(0),\n  workStress: text('work_stress'),\n  socialMin: integer('social_min').default(0),\n  hobbyMin: integer('hobby_min').default(0),\n  topSocialActivities: text('top_social_activities').array(),\n  topHobbies: text('top_hobbies').array(),\n  drugSummary: text('drug_summary'),\n  recoveryDays: jsonb('recovery_days'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n});\n\nexport const analyticsWeekly = pgTable('analytics_weekly', {\n  userId: varchar('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  weekStart: date('week_start').notNull(),\n  kcalAvg: integer('kcal_avg'),\n  tdeeEst: integer('tdee_est'),\n  deficitAvg: integer('deficit_avg'),\n  stepsAvg: integer('steps_avg'),\n  sleepAvgH: numeric('sleep_avg_h', { precision: 4, scale: 2 }),\n  trendLossLb: numeric('trend_loss_lb', { precision: 5, scale: 2 }),\n  notes: text('notes'),\n});\n\n// ============================================================================\n// INSERT SCHEMAS (for validation)\n// ============================================================================\n\nexport const insertProfileSchema = createInsertSchema(profiles).omit({\n  userId: true,\n  createdAt: true,\n});\nexport type InsertProfile = z.infer<typeof insertProfileSchema>;\nexport type Profile = typeof profiles.$inferSelect;\n\nexport const insertGoalsSchema = createInsertSchema(goals).omit({\n  userId: true,\n  updatedAt: true,\n});\nexport type InsertGoals = z.infer<typeof insertGoalsSchema>;\nexport type Goals = typeof goals.$inferSelect;\n\nexport const insertSleepSessionSchema = createInsertSchema(sleepSessions).omit({\n  id: true,\n  userId: true,\n});\nexport type InsertSleepSession = z.infer<typeof insertSleepSessionSchema>;\nexport type SleepSession = typeof sleepSessions.$inferSelect;\n\nexport const insertBodyMetricsSchema = createInsertSchema(bodyMetrics).omit({\n  id: true,\n  userId: true,\n});\nexport type InsertBodyMetrics = z.infer<typeof insertBodyMetricsSchema>;\nexport type BodyMetrics = typeof bodyMetrics.$inferSelect;\n\nexport const insertMealSchema = createInsertSchema(meals).omit({\n  id: true,\n  userId: true,\n});\nexport type InsertMeal = z.infer<typeof insertMealSchema>;\nexport type Meal = typeof meals.$inferSelect;\n\nexport const insertWorkoutSchema = createInsertSchema(workouts).omit({\n  id: true,\n  userId: true,\n});\nexport type InsertWorkout = z.infer<typeof insertWorkoutSchema>;\nexport type Workout = typeof workouts.$inferSelect;\n\nexport const insertWorkoutSetSchema = createInsertSchema(workoutSets).omit({\n  id: true,\n});\nexport type InsertWorkoutSet = z.infer<typeof insertWorkoutSetSchema>;\nexport type WorkoutSet = typeof workoutSets.$inferSelect;\n\nexport const insertMentalLogSchema = createInsertSchema(mentalLogs).omit({\n  id: true,\n  userId: true,\n  createdAt: true,\n});\nexport type InsertMentalLog = z.infer<typeof insertMentalLogSchema>;\nexport type MentalLog = typeof mentalLogs.$inferSelect;\n\nexport const insertDreamEntrySchema = createInsertSchema(dreamEntries).omit({\n  id: true,\n  userId: true,\n  createdAt: true,\n});\nexport type InsertDreamEntry = z.infer<typeof insertDreamEntrySchema>;\nexport type DreamEntry = typeof dreamEntries.$inferSelect;\n\nexport const insertMeditationSessionSchema = createInsertSchema(meditationSessions).omit({\n  id: true,\n  userId: true,\n  startedAt: true,\n});\nexport type InsertMeditationSession = z.infer<typeof insertMeditationSessionSchema>;\nexport type MeditationSession = typeof meditationSessions.$inferSelect;\n\nexport const insertDrugUseLogSchema = createInsertSchema(drugUseLogs).omit({\n  id: true,\n  userId: true,\n});\nexport type InsertDrugUseLog = z.infer<typeof insertDrugUseLogSchema>;\nexport type DrugUseLog = typeof drugUseLogs.$inferSelect;\n\nexport const insertWithdrawalSymptomSchema = createInsertSchema(withdrawalSymptoms).omit({\n  id: true,\n  userId: true,\n});\nexport type InsertWithdrawalSymptom = z.infer<typeof insertWithdrawalSymptomSchema>;\nexport type WithdrawalSymptom = typeof withdrawalSymptoms.$inferSelect;\n\nexport const insertWorkLogSchema = createInsertSchema(workLogs).omit({\n  id: true,\n  userId: true,\n});\nexport type InsertWorkLog = z.infer<typeof insertWorkLogSchema>;\nexport type WorkLog = typeof workLogs.$inferSelect;\n\nexport const insertSocialLogSchema = createInsertSchema(socialLogs).omit({\n  id: true,\n  userId: true,\n});\nexport type InsertSocialLog = z.infer<typeof insertSocialLogSchema>;\nexport type SocialLog = typeof socialLogs.$inferSelect;\n\nexport const insertDrugProfileSchema = createInsertSchema(drugProfiles).omit({\n  id: true,\n  userId: true,\n});\nexport type InsertDrugProfile = z.infer<typeof insertDrugProfileSchema>;\nexport type DrugProfile = typeof drugProfiles.$inferSelect;\n","size_bytes":19327},"client/src/lib/streaks/counters.ts":{"content":"// PBJ Health - Streak Counters\n// Calculate current streaks from ordered flags\n\nexport function currentStreak(flagsDesc: boolean[]): number {\n  let n = 0;\n  for (const v of flagsDesc) {\n    if (!v) break;\n    n++;\n  }\n  return n;\n}\n\nexport function currentColorStreak(colorsDesc: ('green' | 'yellow' | 'red')[]) {\n  let greenOnly = 0;\n  let nonRed = 0;\n\n  // Green-only streak\n  for (const c of colorsDesc) {\n    if (c === 'green') greenOnly++;\n    else break;\n  }\n\n  // On-track streak (green or yellow)\n  for (const c of colorsDesc) {\n    if (c !== 'red') nonRed++;\n    else break;\n  }\n\n  return { greenOnly, nonRed };\n}\n","size_bytes":624},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/pages/meditation.tsx":{"content":"// PBJ Health - Meditation Page\nimport { useState, useEffect } from 'react';\nimport { useAuth } from '@/hooks/useAuth';\nimport { DashboardCard } from '@/components/DashboardCard';\nimport { Button } from '@/components/ui/button';\nimport { ArrowLeft } from 'lucide-react';\nimport { Link } from 'wouter';\nimport { startFiveMinTimer, formatTimerDisplay } from '@/lib/mental/meditation';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useToast } from '@/hooks/use-toast';\nimport { getTodayISO } from '@/lib/dateUtils';\n\nexport default function Meditation() {\n  const { isAuthenticated } = useAuth();\n  const [timeLeft, setTimeLeft] = useState(300);\n  const [isRunning, setIsRunning] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const mutation = useMutation({\n    mutationFn: async (data: { date: string; durationMin: number }) => {\n      await apiRequest('POST', '/api/meditation', data);\n    },\n    onSuccess: () => {\n      toast({ title: 'Meditation session logged!' });\n      queryClient.invalidateQueries({ queryKey: ['/api/analytics/daily'] });\n    },\n    onError: (error: Error) => {\n      toast({ title: 'Error', description: error.message, variant: 'destructive' });\n    },\n  });\n\n  useEffect(() => {\n    if (!isRunning) return;\n    \n    const cleanup = startFiveMinTimer(\n      (secLeft) => setTimeLeft(secLeft),\n      () => {\n        setIsRunning(false);\n        setTimeLeft(300);\n        mutation.mutate({ date: getTodayISO(), durationMin: 5 });\n      }\n    );\n    \n    return cleanup;\n  }, [isRunning]);\n\n  const handleStart = () => {\n    setIsRunning(true);\n  };\n\n  const handleStop = () => {\n    setIsRunning(false);\n    setTimeLeft(300);\n  };\n\n  if (!isAuthenticated) return null;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b sticky top-0 bg-background/95 backdrop-blur z-50\">\n        <div className=\"max-w-2xl mx-auto px-4 py-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Today\n            </Button>\n          </Link>\n        </div>\n      </header>\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\n        <h1 className=\"text-3xl font-bold mb-8\">Meditation</h1>\n        <DashboardCard title=\"5-Minute Mindfulness\">\n          <div className=\"text-center space-y-6\">\n            <div className=\"text-6xl font-mono font-bold text-primary\">\n              {formatTimerDisplay(timeLeft)}\n            </div>\n            <div className=\"flex gap-4 justify-center\">\n              {!isRunning ? (\n                <Button size=\"lg\" onClick={handleStart} data-testid=\"button-start-timer\">\n                  Start 5-Min Session\n                </Button>\n              ) : (\n                <Button size=\"lg\" variant=\"destructive\" onClick={handleStop} data-testid=\"button-stop-timer\">\n                  Stop\n                </Button>\n              )}\n            </div>\n            <p className=\"text-sm text-muted-foreground\">\n              Find a quiet place, close your eyes, and focus on your breath\n            </p>\n          </div>\n        </DashboardCard>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3278},"client/src/lib/mental/meditation.ts":{"content":"// PBJ Health - Meditation Timer\n// 5-minute default timer with callbacks\n\nexport function startFiveMinTimer(\n  onTick: (secLeft: number) => void,\n  onDone: () => void\n): () => void {\n  let left = 300; // 5 minutes in seconds\n  const id = setInterval(() => {\n    left -= 1;\n    onTick(left);\n    if (left <= 0) {\n      clearInterval(id);\n      onDone();\n    }\n  }, 1000);\n\n  // Return cleanup function\n  return () => clearInterval(id);\n}\n\nexport function startCustomTimer(\n  durationMin: number,\n  onTick: (secLeft: number) => void,\n  onDone: () => void\n): () => void {\n  let left = durationMin * 60;\n  const id = setInterval(() => {\n    left -= 1;\n    onTick(left);\n    if (left <= 0) {\n      clearInterval(id);\n      onDone();\n    }\n  }, 1000);\n\n  return () => clearInterval(id);\n}\n\nexport function formatTimerDisplay(seconds: number): string {\n  const mins = Math.floor(seconds / 60);\n  const secs = seconds % 60;\n  return `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;\n}\n","size_bytes":997},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/pages/work.tsx":{"content":"// PBJ Health - Work & Stress Page\nimport { useState } from 'react';\nimport { useAuth } from '@/hooks/useAuth';\nimport { DashboardCard } from '@/components/DashboardCard';\nimport { Button } from '@/components/ui/button';\nimport { Label } from '@/components/ui/label';\nimport { ArrowLeft } from 'lucide-react';\nimport { Link } from 'wouter';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useToast } from '@/hooks/use-toast';\nimport { getTodayISO } from '@/lib/dateUtils';\n\nexport default function Work() {\n  const { isAuthenticated } = useAuth();\n  const [stress, setStress] = useState<'low' | 'medium' | 'high'>('medium');\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const mutation = useMutation({\n    mutationFn: async (data: { date: string; stress: string }) => {\n      await apiRequest('POST', '/api/work', data);\n    },\n    onSuccess: () => {\n      toast({ title: 'Work log saved successfully!' });\n      queryClient.invalidateQueries({ queryKey: ['/api/work'] });\n    },\n    onError: (error: Error) => {\n      toast({ title: 'Error', description: error.message, variant: 'destructive' });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    mutation.mutate({ date: getTodayISO(), stress });\n  };\n\n  if (!isAuthenticated) return null;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b sticky top-0 bg-background/95 backdrop-blur z-50\">\n        <div className=\"max-w-2xl mx-auto px-4 py-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Today\n            </Button>\n          </Link>\n        </div>\n      </header>\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\n        <h1 className=\"text-3xl font-bold mb-8\">Work & Stress</h1>\n        <DashboardCard title=\"How was work yesterday?\">\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <div>\n              <Label>Stress Level</Label>\n              <div className=\"grid grid-cols-3 gap-4 mt-2\">\n                <Button\n                  type=\"button\"\n                  variant={stress === 'low' ? 'default' : 'outline'}\n                  onClick={() => setStress('low')}\n                  data-testid=\"button-stress-low\"\n                >\n                  Low\n                </Button>\n                <Button\n                  type=\"button\"\n                  variant={stress === 'medium' ? 'default' : 'outline'}\n                  onClick={() => setStress('medium')}\n                  data-testid=\"button-stress-medium\"\n                >\n                  Medium\n                </Button>\n                <Button\n                  type=\"button\"\n                  variant={stress === 'high' ? 'default' : 'outline'}\n                  onClick={() => setStress('high')}\n                  data-testid=\"button-stress-high\"\n                >\n                  High\n                </Button>\n              </div>\n            </div>\n            <Button type=\"submit\" disabled={mutation.isPending} data-testid=\"button-log-work\">\n              {mutation.isPending ? 'Logging...' : 'Log Work Stress'}\n            </Button>\n          </form>\n        </DashboardCard>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3365},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/pages/social.tsx":{"content":"// PBJ Health - Social Activities Page\nimport { useState } from 'react';\nimport { useAuth } from '@/hooks/useAuth';\nimport { DashboardCard } from '@/components/DashboardCard';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { ArrowLeft } from 'lucide-react';\nimport { Link } from 'wouter';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useToast } from '@/hooks/use-toast';\nimport { getTodayISO } from '@/lib/dateUtils';\n\nexport default function Social() {\n  const { isAuthenticated } = useAuth();\n  const [activity, setActivity] = useState('');\n  const [durationMin, setDurationMin] = useState('');\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const mutation = useMutation({\n    mutationFn: async (data: { date: string; activity: string; durationMin?: number }) => {\n      await apiRequest('POST', '/api/social', data);\n    },\n    onSuccess: () => {\n      toast({ title: 'Social activity logged!' });\n      queryClient.invalidateQueries({ queryKey: ['/api/social'] });\n      setActivity('');\n      setDurationMin('');\n    },\n    onError: (error: Error) => {\n      toast({ title: 'Error', description: error.message, variant: 'destructive' });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!activity) {\n      toast({ title: 'Error', description: 'Please describe the activity', variant: 'destructive' });\n      return;\n    }\n    mutation.mutate({\n      date: getTodayISO(),\n      activity,\n      durationMin: durationMin ? parseInt(durationMin) : undefined,\n    });\n  };\n\n  if (!isAuthenticated) return null;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b sticky top-0 bg-background/95 backdrop-blur z-50\">\n        <div className=\"max-w-2xl mx-auto px-4 py-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Today\n            </Button>\n          </Link>\n        </div>\n      </header>\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\n        <h1 className=\"text-3xl font-bold mb-8\">Social Activities</h1>\n        <DashboardCard title=\"Log Social Interaction\">\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"activity\">Activity</Label>\n              <Input\n                id=\"activity\"\n                value={activity}\n                onChange={(e) => setActivity(e.target.value)}\n                placeholder=\"Dinner with friends, phone call with family...\"\n                data-testid=\"input-social-activity\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"duration\">Duration (minutes) - Optional</Label>\n              <Input\n                id=\"duration\"\n                type=\"number\"\n                value={durationMin}\n                onChange={(e) => setDurationMin(e.target.value)}\n                placeholder=\"60\"\n                data-testid=\"input-social-duration\"\n              />\n            </div>\n            <Button type=\"submit\" disabled={mutation.isPending} data-testid=\"button-log-social\">\n              {mutation.isPending ? 'Logging...' : 'Log Activity'}\n            </Button>\n          </form>\n        </DashboardCard>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3480},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/DashboardCard.tsx":{"content":"// PBJ Health - Dashboard Card Component\n// Card-first design for health metrics\nimport { Card, CardHeader, CardTitle, CardDescription, CardContent, CardFooter } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { ArrowRight } from 'lucide-react';\nimport { Link } from 'wouter';\n\ninterface DashboardCardProps {\n  title: string;\n  description?: string;\n  children: React.ReactNode;\n  footer?: React.ReactNode;\n  actionLabel?: string;\n  actionHref?: string;\n  onAction?: () => void;\n  className?: string;\n  testId?: string;\n}\n\nexport function DashboardCard({\n  title,\n  description,\n  children,\n  footer,\n  actionLabel,\n  actionHref,\n  onAction,\n  className = '',\n  testId,\n}: DashboardCardProps) {\n  return (\n    <Card className={`hover-elevate ${className}`} data-testid={testId}>\n      <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n        <div className=\"flex-1\">\n          <CardTitle className=\"text-lg font-semibold\">{title}</CardTitle>\n          {description && (\n            <CardDescription className=\"text-sm mt-1\">{description}</CardDescription>\n          )}\n        </div>\n        {actionLabel && (\n          <div>\n            {actionHref ? (\n              <Link href={actionHref}>\n                <Button variant=\"default\" size=\"sm\" data-testid={`button-${testId}-action`}>\n                  {actionLabel}\n                  <ArrowRight className=\"h-4 w-4 ml-1\" />\n                </Button>\n              </Link>\n            ) : (\n              <Button variant=\"default\" size=\"sm\" onClick={onAction} data-testid={`button-${testId}-action`}>\n                {actionLabel}\n                <ArrowRight className=\"h-4 w-4 ml-1\" />\n              </Button>\n            )}\n          </div>\n        )}\n      </CardHeader>\n      <CardContent className=\"pt-4\">{children}</CardContent>\n      {footer && <CardFooter className=\"text-sm text-muted-foreground\">{footer}</CardFooter>}\n    </Card>\n  );\n}\n","size_bytes":1976},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/components/ThemeToggle.tsx":{"content":"// PBJ Health - Theme Toggle Component\nimport { Moon, Sun } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { useEffect, useState } from 'react';\n\nexport function ThemeToggle() {\n  const [theme, setTheme] = useState<'light' | 'dark'>('light');\n\n  useEffect(() => {\n    const stored = localStorage.getItem('theme') as 'light' | 'dark' | null;\n    const systemPreference = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\n    const initialTheme = stored || systemPreference;\n    setTheme(initialTheme);\n    document.documentElement.classList.toggle('dark', initialTheme === 'dark');\n  }, []);\n\n  const toggleTheme = () => {\n    const newTheme = theme === 'light' ? 'dark' : 'light';\n    setTheme(newTheme);\n    localStorage.setItem('theme', newTheme);\n    document.documentElement.classList.toggle('dark', newTheme === 'dark');\n  };\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={toggleTheme}\n      aria-label=\"Toggle theme\"\n      data-testid=\"button-theme-toggle\"\n    >\n      {theme === 'light' ? (\n        <Moon className=\"h-5 w-5\" />\n      ) : (\n        <Sun className=\"h-5 w-5\" />\n      )}\n    </Button>\n  );\n}\n","size_bytes":1203},"client/src/lib/streaks/evaluator.ts":{"content":"// PBJ Health - Streak Evaluator\n// Based on specification from documentation\nimport { DateTime } from 'luxon';\n\ntype Tz = string;\n\nexport type DailyInputs = {\n  tz: Tz;\n  dateISO: string;\n  kcalGoal: number;\n  meals: Array<{ calories: number }>;\n  sleepSessionsEndingToday: Array<{ startAt: string; endAt: string }>;\n  workouts: Array<{ startAt?: string; endAt?: string; durationMin?: number }>;\n};\n\nexport type DailyResult = {\n  dateISO: string;\n  sleepMin: number;\n  sleepOk: boolean;\n  kcalIntake: number;\n  kcalGoal: number;\n  kcalDelta: number;\n  kcalStatus: 'UN' | 'OV' | 'GOAL';\n  kcalOk: boolean;\n  gymOk: boolean;\n  gymStartAt?: string;\n  gymEndAt?: string;\n  gymDurationMin: number;\n  scoreSmall: 0 | 1 | 2 | 3;\n  color: 'green' | 'yellow' | 'red';\n  caloriesChip: string;\n  sleepChip: string;\n  gymChip: string;\n};\n\nconst fmtHM = (m: number) => {\n  const h = Math.floor(m / 60);\n  const mm = m % 60;\n  return `${h}h${String(mm).padStart(2, '0')}m`;\n};\n\nexport function evaluateDaily(inputs: DailyInputs): DailyResult {\n  const { tz, dateISO, kcalGoal } = inputs;\n\n  // Calculate calories\n  const kcalIntake = Math.max(\n    0,\n    Math.round(inputs.meals.reduce((s, m) => s + (m.calories || 0), 0))\n  );\n  const kcalDelta = kcalIntake - kcalGoal;\n  let kcalStatus: 'UN' | 'OV' | 'GOAL' =\n    kcalDelta < 0 ? 'UN' : kcalDelta > 0 ? 'OV' : 'GOAL';\n  const kcalOk = kcalIntake <= kcalGoal;\n\n  // Calculate sleep (sessions that END today)\n  const sleepMin = Math.round(\n    inputs.sleepSessionsEndingToday.reduce((sum, s) => {\n      const start = DateTime.fromISO(s.startAt).setZone(tz);\n      const end = DateTime.fromISO(s.endAt).setZone(tz);\n      return sum + Math.max(0, end.diff(start, 'minutes').minutes);\n    }, 0)\n  );\n  const sleepOk = sleepMin >= 360; // ≥ 6 hours\n\n  // Calculate gym duration\n  let gymDuration = 0;\n  let firstStart: DateTime | undefined;\n  let lastEnd: DateTime | undefined;\n  const dayStart = DateTime.fromISO(dateISO, { zone: tz }).startOf('day');\n  const dayEnd = dayStart.endOf('day');\n\n  inputs.workouts.forEach((w) => {\n    let mins = w.durationMin ?? 0;\n    const ws = w.startAt ? DateTime.fromISO(w.startAt).setZone(tz) : undefined;\n    const we = w.endAt ? DateTime.fromISO(w.endAt).setZone(tz) : undefined;\n\n    if (ws && we) {\n      const cs = ws < dayStart ? dayStart : ws;\n      const ce = we > dayEnd ? dayEnd : we;\n      mins = Math.max(0, ce.diff(cs, 'minutes').minutes);\n      firstStart = firstStart ? (ws < firstStart ? ws : firstStart) : ws;\n      lastEnd = lastEnd ? (we > lastEnd ? we : lastEnd) : we;\n    }\n    gymDuration += Math.round(Math.max(0, mins));\n  });\n\n  const gymOk = gymDuration > 0;\n\n  // Calculate score and color\n  const score = ((sleepOk ? 1 : 0) +\n    (kcalOk ? 1 : 0) +\n    (gymOk ? 1 : 0)) as 0 | 1 | 2 | 3;\n  const color: 'green' | 'yellow' | 'red' =\n    score === 3 ? 'green' : score === 2 ? 'yellow' : 'red';\n\n  // Format chips (exact format from spec)\n  const caloriesChip = `${kcalIntake}/${kcalGoal} ${kcalStatus} ${kcalDelta === 0 ? '0' : kcalDelta > 0 ? `+${kcalDelta}` : `${kcalDelta}`}`;\n  const sleepChip = `${fmtHM(sleepMin)} ${sleepOk ? '✅' : '❌'}`;\n  const gymChip = gymOk\n    ? `✅ ${fmtHM(gymDuration)}${firstStart && lastEnd ? ` (${firstStart.toFormat('t')}–${lastEnd.toFormat('t')})` : ''}`\n    : '❌';\n\n  return {\n    dateISO,\n    sleepMin,\n    sleepOk,\n    kcalIntake,\n    kcalGoal,\n    kcalDelta,\n    kcalStatus,\n    kcalOk,\n    gymOk,\n    gymStartAt: firstStart?.toISO(),\n    gymEndAt: lastEnd?.toISO(),\n    gymDurationMin: Math.round(gymDuration),\n    scoreSmall: score,\n    color,\n    caloriesChip,\n    sleepChip,\n    gymChip,\n  };\n}\n","size_bytes":3648},"client/src/pages/recovery.tsx":{"content":"// PBJ Health - Recovery & Substances Page\nimport { useAuth } from '@/hooks/useAuth';\nimport { DashboardCard } from '@/components/DashboardCard';\nimport { Button } from '@/components/ui/button';\nimport { ArrowLeft } from 'lucide-react';\nimport { Link } from 'wouter';\n\nexport default function Recovery() {\n  const { isAuthenticated } = useAuth();\n\n  if (!isAuthenticated) return null;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b sticky top-0 bg-background/95 backdrop-blur z-50\">\n        <div className=\"max-w-2xl mx-auto px-4 py-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Today\n            </Button>\n          </Link>\n        </div>\n      </header>\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\n        <h1 className=\"text-3xl font-bold mb-8\">Recovery & Substances</h1>\n        <DashboardCard title=\"Track Your Recovery\">\n          <p className=\"text-muted-foreground\">\n            Monitor your journey with clean-days counter and substance tracking.\n          </p>\n        </DashboardCard>\n      </div>\n    </div>\n  );\n}\n","size_bytes":1189},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1080},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/pages/landing.tsx":{"content":"// PBJ LYFE - Landing Page\nimport { Button } from '@/components/ui/button';\nimport { Activity, TrendingDown, Moon, Dumbbell, Zap, Brain, Heart } from 'lucide-react';\nimport { Link } from 'wouter';\n\nexport default function Landing() {\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Hero Section */}\n      <div className=\"relative bg-gradient-to-b from-primary/10 to-background overflow-hidden\">\n        <div className=\"max-w-6xl mx-auto px-4 py-24\">\n          <div className=\"text-center space-y-8\">\n            <div className=\"inline-block\">\n              <div className=\"flex items-center justify-center gap-3 mb-6\">\n                <Activity className=\"h-14 w-14 text-primary\" />\n                <h1 className=\"text-6xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent\">\n                  PBJ LYFE\n                </h1>\n              </div>\n            </div>\n            <p className=\"text-3xl font-semibold text-foreground max-w-3xl mx-auto\">\n              One simple daily flow to track your Lyfe.\n            </p>\n            <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto\">\n              Track your health, build streaks, and achieve sustainable health goals with mental health & lifestyle insights.\n            </p>\n            <div className=\"flex flex-col sm:flex-row gap-4 justify-center items-center pt-8\">\n              <Button\n                size=\"lg\"\n                onClick={() => (window.location.href = '/api/login')}\n                className=\"min-w-[200px] text-lg h-14\"\n                data-testid=\"button-login\"\n              >\n                Get Started\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Features Section */}\n      <div id=\"features\" className=\"max-w-6xl mx-auto px-4 py-20\">\n        <div className=\"text-center mb-16\">\n          <h2 className=\"text-4xl font-bold mb-4\">Everything You Need to Win Your Day</h2>\n          <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto\">\n            PBJ LYFE keeps it simple: one place to log, learn, and level up—without the noise.\n          </p>\n        </div>\n\n        <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-8\">\n          <FeatureCard\n            icon={<TrendingDown className=\"h-10 w-10 text-chart-1\" />}\n            title=\"Food, Weight & Trends\"\n            description=\"Log meals in seconds and let PBJ LYFE do the math. See calories, protein, and weekly trend lines that smooth out the noise so you stay consistent—not obsessed.\"\n            shortCopy=\"Quick logging, smart trends, real progress.\"\n          />\n          <FeatureCard\n            icon={<Moon className=\"h-10 w-10 text-chart-2\" />}\n            title=\"Sleep & Recovery\"\n            description=\"Record sleep and quality each morning. PBJ LYFE highlights patterns and nudges you toward the 6–8 hour sweet spot that powers fat loss, focus, and mood.\"\n            shortCopy=\"Better sleep, better days.\"\n          />\n          <FeatureCard\n            icon={<Dumbbell className=\"h-10 w-10 text-chart-3\" />}\n            title=\"Workouts that Build\"\n            description=\"Track check-in/out times, exercises, sets, and PRs. Auto-progression suggestions keep you moving forward—even on busy weeks.\"\n            shortCopy=\"Log it. Level up. Repeat.\"\n          />\n          <FeatureCard\n            icon={<Zap className=\"h-10 w-10 text-chart-4\" />}\n            title=\"Streaks that Stick\"\n            description=\"Green (3/3), Yellow (2/3), Red (0–1/3). Simple daily targets that build momentum, not guilt. Miss a day? PBJ LYFE helps you bounce back fast.\"\n            shortCopy=\"Momentum you can feel.\"\n          />\n          <FeatureCard\n            icon={<Brain className=\"h-10 w-10 text-chart-5\" />}\n            title=\"Mind, Mood & Headspace\"\n            description=\"Tap in your mood, note dreams, breathe for a minute. PBJ LYFE connects mental health and habits so you can see what actually helps you feel good.\"\n            shortCopy=\"Track how you feel, not just what you do.\"\n          />\n          <FeatureCard\n            icon={<Heart className=\"h-10 w-10 text-destructive\" />}\n            title=\"Life, Social & Stress\"\n            description=\"Log work stress, social nights, and off days. PBJ LYFE shows how real-life choices affect sleep, weight, and workouts—no shame, just clarity.\"\n            shortCopy=\"Real life, reflected in your data.\"\n          />\n        </div>\n      </div>\n\n      {/* Benefits Strip */}\n      <div className=\"bg-muted/30 py-12\">\n        <div className=\"max-w-6xl mx-auto px-4\">\n          <div className=\"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 text-center\">\n            <BenefitItem \n              title=\"Personal, not perfect\" \n              subtitle=\"Rewards consistency over all-or-nothing streaks\"\n            />\n            <BenefitItem \n              title=\"Your data, your pace\" \n              subtitle=\"One simple daily flow—no clutter, no 20-step setup\"\n            />\n            <BenefitItem \n              title=\"Whole-human view\" \n              subtitle=\"Health + habits + headspace in one place\"\n            />\n            <BenefitItem \n              title=\"Sustainable wins\" \n              subtitle=\"Tiny actions that compound into big changes\"\n            />\n          </div>\n        </div>\n      </div>\n\n      {/* Microcopy Section */}\n      <div className=\"max-w-4xl mx-auto px-4 py-16\">\n        <div className=\"grid sm:grid-cols-2 gap-8 text-center\">\n          <div className=\"p-6\">\n            <p className=\"text-2xl font-semibold text-primary mb-2\">Log today. Win the week.</p>\n          </div>\n          <div className=\"p-6\">\n            <p className=\"text-2xl font-semibold text-primary mb-2\">Small moves. Big momentum.</p>\n          </div>\n        </div>\n      </div>\n\n      {/* CTA Section */}\n      <div className=\"bg-gradient-to-b from-primary/5 to-background py-20\">\n        <div className=\"max-w-4xl mx-auto px-4 text-center space-y-8\">\n          <h2 className=\"text-4xl font-bold\">Ready to Start Your Journey?</h2>\n          <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto\">\n            Missed a day? We'll help you restart. Your pace, your progress.\n          </p>\n          <Button\n            size=\"lg\"\n            onClick={() => (window.location.href = '/api/login')}\n            className=\"min-w-[240px] text-lg h-14\"\n            data-testid=\"button-login-cta\"\n          >\n            Get Started Free\n          </Button>\n        </div>\n      </div>\n\n      {/* Footer */}\n      <footer className=\"border-t py-8\">\n        <div className=\"max-w-6xl mx-auto px-4 text-center text-sm text-muted-foreground\">\n          <p>© 2024 PBJ LYFE. Your health tracking companion.</p>\n        </div>\n      </footer>\n    </div>\n  );\n}\n\nfunction FeatureCard({\n  icon,\n  title,\n  description,\n  shortCopy,\n}: {\n  icon: React.ReactNode;\n  title: string;\n  description: string;\n  shortCopy: string;\n}) {\n  return (\n    <div className=\"flex flex-col items-start p-6 rounded-xl border bg-card hover-elevate transition-all\">\n      <div className=\"mb-4 p-3 rounded-lg bg-muted/50\">{icon}</div>\n      <h3 className=\"text-xl font-semibold mb-3\">{title}</h3>\n      <p className=\"text-sm text-muted-foreground mb-3 flex-1\">{description}</p>\n      <p className=\"text-sm font-medium text-primary italic\">{shortCopy}</p>\n    </div>\n  );\n}\n\nfunction BenefitItem({ title, subtitle }: { title: string; subtitle: string }) {\n  return (\n    <div className=\"space-y-1\">\n      <h4 className=\"font-semibold text-foreground\">{title}</h4>\n      <p className=\"text-sm text-muted-foreground\">{subtitle}</p>\n    </div>\n  );\n}\n","size_bytes":7677},"client/src/lib/authUtils.ts":{"content":"// Reference: Replit Auth blueprint\nexport function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}\n","size_bytes":152},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\n","size_bytes":483},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"client/src/lib/mental/dreams.ts":{"content":"// PBJ Health - Dream Analysis\n// AI analysis stub for MVP\n\nexport type Dream = {\n  title?: string;\n  narrative: string;\n  tags?: string[];\n  emotion?: number;\n  intensity?: number;\n  dateISO: string;\n};\n\nexport async function analyzeDreams(\n  dreams: Dream[],\n  scope: 'single' | 'week'\n): Promise<{ summary: string; themes: string[]; advice: string }> {\n  const text = dreams.map((d) => d.narrative).join('\\n---\\n');\n\n  if (!text.trim()) {\n    return {\n      summary: 'No dream text provided.',\n      themes: [],\n      advice: 'Add a few details next time.',\n    };\n  }\n\n  // Simple keyword-based theme detection for MVP\n  const themes: string[] = [];\n  if (/car|vehicle|crash/i.test(text)) themes.push('travel/safety');\n  if (/fall|falling/i.test(text)) themes.push('control/instability');\n  if (/chase|run/i.test(text)) themes.push('avoidance/anxiety');\n  if (/water|ocean|swim/i.test(text)) themes.push('emotions/flow');\n  if (/fly|flying/i.test(text)) themes.push('freedom/ambition');\n\n  const summary = `You logged ${dreams.length} dream(s). Common themes: ${themes.join(', ') || '—'}.`;\n  const advice =\n    'Wind-down routine: dim lights and 5–10 min breathing before bed.';\n\n  return { summary, themes, advice };\n}\n","size_bytes":1229},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/pages/dreams.tsx":{"content":"// PBJ Health - Dreams Journal Page\nimport { useState } from 'react';\nimport { useAuth } from '@/hooks/useAuth';\nimport { DashboardCard } from '@/components/DashboardCard';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { ArrowLeft } from 'lucide-react';\nimport { Link } from 'wouter';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useToast } from '@/hooks/use-toast';\nimport { getTodayISO } from '@/lib/dateUtils';\n\nexport default function Dreams() {\n  const { isAuthenticated } = useAuth();\n  const [title, setTitle] = useState('');\n  const [narrative, setNarrative] = useState('');\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const mutation = useMutation({\n    mutationFn: async (data: { date: string; title: string; narrative: string }) => {\n      await apiRequest('POST', '/api/dreams', data);\n    },\n    onSuccess: () => {\n      toast({ title: 'Dream logged successfully!' });\n      queryClient.invalidateQueries({ queryKey: ['/api/dreams'] });\n      setTitle('');\n      setNarrative('');\n    },\n    onError: (error: Error) => {\n      toast({ title: 'Error', description: error.message, variant: 'destructive' });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!title || !narrative) {\n      toast({ title: 'Error', description: 'Please fill in all fields', variant: 'destructive' });\n      return;\n    }\n    mutation.mutate({ date: getTodayISO(), title, narrative });\n  };\n\n  if (!isAuthenticated) return null;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b sticky top-0 bg-background/95 backdrop-blur z-50\">\n        <div className=\"max-w-2xl mx-auto px-4 py-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Today\n            </Button>\n          </Link>\n        </div>\n      </header>\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\n        <h1 className=\"text-3xl font-bold mb-8\">Dream Journal</h1>\n        <DashboardCard title=\"Log Last Night's Dream\">\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"title\">Title</Label>\n              <Input\n                id=\"title\"\n                value={title}\n                onChange={(e) => setTitle(e.target.value)}\n                placeholder=\"What was your dream about?\"\n                data-testid=\"input-dream-title\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"narrative\">Dream Details</Label>\n              <Textarea\n                id=\"narrative\"\n                value={narrative}\n                onChange={(e) => setNarrative(e.target.value)}\n                placeholder=\"Describe what happened in your dream...\"\n                rows={6}\n                data-testid=\"input-dream-narrative\"\n              />\n            </div>\n            <Button type=\"submit\" disabled={mutation.isPending} data-testid=\"button-log-dream\">\n              {mutation.isPending ? 'Logging...' : 'Log Dream'}\n            </Button>\n          </form>\n        </DashboardCard>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3413},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE - PBJ Studios Cloud Mode */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n\n  /* Automatic computation of border around primary / danger buttons */\n  --opaque-button-border-intensity: -8; /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n\n  /* PBJ Cloud/Light backgrounds */\n  --background: 0 0% 99%;\n  --foreground: 218 11% 6%;\n  --border: 220 10% 91%;\n  --card: 0 0% 98%;\n  --card-foreground: 218 11% 6%;\n  --card-border: 220 10% 93%;\n\n  --sidebar: 0 0% 96%;\n  --sidebar-foreground: 218 11% 6%;\n  --sidebar-border: 220 10% 90%;\n  --sidebar-primary: 282 85% 49%;\n  --sidebar-primary-foreground: 0 0% 100%;\n  --sidebar-accent: 0 0% 92%;\n  --sidebar-accent-foreground: 218 11% 15%;\n  --sidebar-ring: 282 85% 49%;\n\n  --popover: 0 0% 98%;\n  --popover-foreground: 218 11% 6%;\n  --popover-border: 220 10% 88%;\n\n  /* PBJ Purple primary */\n  --primary: 282 85% 49%;\n  --primary-foreground: 0 0% 100%;\n\n  /* PBJ Gold secondary */\n  --secondary: 26 48% 54%;\n  --secondary-foreground: 26 83% 14%;\n\n  --muted: 220 10% 92%;\n  --muted-foreground: 220 6% 55%;\n\n  --accent: 220 10% 90%;\n  --accent-foreground: 218 11% 20%;\n\n  /* Hot Coral for errors */\n  --destructive: 350 100% 67%;\n  --destructive-foreground: 0 0% 100%;\n\n  --input: 220 10% 75%;\n  --ring: 282 85% 49%;\n  \n  /* Chart colors */\n  --chart-1: 282 85% 49%;\n  --chart-2: 26 48% 54%;\n  --chart-3: 170 87% 55%;\n  --chart-4: 208 100% 64%;\n  --chart-5: 350 100% 67%;\n  \n  /* Streak colors for gamification */\n  --streak-green: 170 87% 55%;\n  --streak-green-foreground: 170 83% 14%;\n  --streak-yellow: 37 100% 64%;\n  --streak-yellow-foreground: 26 83% 14%;\n  --streak-red: 350 100% 67%;\n  --streak-red-foreground: 0 0% 100%;\n\n  --font-sans: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: 'JetBrains Mono', Menlo, Monaco, 'Courier New', monospace;\n  --radius: 1.25rem; /* 20px - PBJ radius */\n  --shadow-2xs: 0px 1px 1px 0px hsl(0 0% 0% / 0.03);\n  --shadow-xs: 0px 1px 2px 0px hsl(0 0% 0% / 0.05);\n  --shadow-sm: 0px 2px 4px -1px hsl(0 0% 0% / 0.06), 0px 1px 2px -1px hsl(0 0% 0% / 0.04);\n  --shadow: 0 1px 0 rgba(255,255,255,.03), 0 6px 16px rgba(0,0,0,.15);\n  --shadow-md: 0px 6px 12px -2px hsl(0 0% 0% / 0.10), 0px 3px 6px -3px hsl(0 0% 0% / 0.06);\n  --shadow-lg: 0px 10px 20px -3px hsl(0 0% 0% / 0.12), 0px 4px 8px -4px hsl(0 0% 0% / 0.08);\n  --shadow-xl: 0px 20px 30px -5px hsl(0 0% 0% / 0.15), 0px 8px 12px -6px hsl(0 0% 0% / 0.10);\n  --shadow-2xl: 0px 25px 40px -10px hsl(0 0% 0% / 0.20);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n  /* Automatically computed borders - intensity can be controlled by the user by the --opaque-button-border-intensity setting */\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n\n  --opaque-button-border-intensity: 9;  /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n\n  /* PBJ Ink/Coal/Slate - Dark-first UI */\n  --background: 218 15% 5%;\n  --foreground: 220 8% 94%;\n  --border: 220 8% 15%;\n  --card: 218 12% 7%;\n  --card-foreground: 220 8% 94%;\n  --card-border: 220 8% 12%;\n\n  --sidebar: 218 13% 8%;\n  --sidebar-foreground: 220 8% 94%;\n  --sidebar-border: 220 8% 14%;\n  --sidebar-primary: 282 85% 49%;\n  --sidebar-primary-foreground: 0 0% 100%;\n  --sidebar-accent: 220 10% 11%;\n  --sidebar-accent-foreground: 220 8% 90%;\n  --sidebar-ring: 282 85% 49%;\n\n  --popover: 218 12% 9%;\n  --popover-foreground: 220 8% 94%;\n  --popover-border: 220 8% 16%;\n\n  /* PBJ Purple primary */\n  --primary: 282 85% 49%;\n  --primary-foreground: 0 0% 100%;\n\n  /* PBJ Gold secondary */\n  --secondary: 26 48% 54%;\n  --secondary-foreground: 218 15% 5%;\n\n  --muted: 220 10% 14%;\n  --muted-foreground: 220 6% 60%;\n\n  --accent: 220 10% 12%;\n  --accent-foreground: 220 8% 88%;\n\n  /* Hot Coral for errors */\n  --destructive: 350 100% 67%;\n  --destructive-foreground: 0 0% 100%;\n\n  /* Used as the border around inputs. Dark mode: Should be a border that is light enough to have high contrast when rendered on a --card background. More contrast than standard --border */\n  --input: 220 8% 25%;\n  --ring: 282 85% 49%;\n  \n  /* Chart colors - vibrant in dark */\n  --chart-1: 282 85% 55%;\n  --chart-2: 26 48% 60%;\n  --chart-3: 170 87% 60%;\n  --chart-4: 208 100% 68%;\n  --chart-5: 350 100% 70%;\n  \n  /* Streak colors for gamification - dark mode */\n  --streak-green: 170 87% 60%;\n  --streak-green-foreground: 170 83% 14%;\n  --streak-yellow: 37 100% 68%;\n  --streak-yellow-foreground: 26 83% 14%;\n  --streak-red: 350 100% 70%;\n  --streak-red-foreground: 0 0% 100%;\n\n  --shadow-2xs: 0px 1px 1px 0px hsl(0 0% 0% / 0.15);\n  --shadow-xs: 0px 1px 2px 0px hsl(0 0% 0% / 0.20);\n  --shadow-sm: 0px 2px 4px -1px hsl(0 0% 0% / 0.25), 0px 1px 2px -1px hsl(0 0% 0% / 0.15);\n  --shadow: 0 1px 0 rgba(255,255,255,.03), 0 6px 16px rgba(0,0,0,.35);\n  --shadow-md: 0px 6px 12px -2px hsl(0 0% 0% / 0.35), 0px 3px 6px -3px hsl(0 0% 0% / 0.25);\n  --shadow-lg: 0px 10px 20px -3px hsl(0 0% 0% / 0.40), 0px 4px 8px -4px hsl(0 0% 0% / 0.30);\n  --shadow-xl: 0px 20px 30px -5px hsl(0 0% 0% / 0.45), 0px 8px 12px -6px hsl(0 0% 0% / 0.35);\n  --shadow-2xl: 0px 25px 40px -10px hsl(0 0% 0% / 0.50);\n\n  /* Automatically computed borders - intensity can be controlled by the user by the --opaque-button-border-intensity setting */\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}","size_bytes":12386},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/EmptyState.tsx":{"content":"// PBJ Health - Empty State Component\nimport { LucideIcon } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\n\ninterface EmptyStateProps {\n  icon: LucideIcon;\n  title: string;\n  description: string;\n  actionLabel?: string;\n  onAction?: () => void;\n  testId?: string;\n}\n\nexport function EmptyState({\n  icon: Icon,\n  title,\n  description,\n  actionLabel,\n  onAction,\n  testId,\n}: EmptyStateProps) {\n  return (\n    <div\n      className=\"flex flex-col items-center justify-center py-12 px-4 text-center\"\n      data-testid={testId || 'empty-state'}\n    >\n      <div className=\"rounded-full bg-muted p-6 mb-4\">\n        <Icon className=\"h-12 w-12 text-muted-foreground\" />\n      </div>\n      <h3 className=\"text-lg font-semibold mb-2\">{title}</h3>\n      <p className=\"text-sm text-muted-foreground max-w-sm mb-6\">{description}</p>\n      {actionLabel && onAction && (\n        <Button onClick={onAction} data-testid={`button-${testId}-action`}>\n          {actionLabel}\n        </Button>\n      )}\n    </div>\n  );\n}\n","size_bytes":1024},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/pages/today.tsx":{"content":"// PBJ Health - Today Dashboard\n// Main daily tracking screen with all health cards\nimport { useEffect, useState } from 'react';\nimport { useAuth } from '@/hooks/useAuth';\nimport { useToast } from '@/hooks/use-toast';\nimport { useQuery } from '@tanstack/react-query';\nimport { DashboardCard } from '@/components/DashboardCard';\nimport { StatusChip } from '@/components/StatusChip';\nimport { EmptyState } from '@/components/EmptyState';\nimport { ThemeToggle } from '@/components/ThemeToggle';\nimport { Button } from '@/components/ui/button';\nimport { DailyCheckInWizard } from '@/components/DailyCheckInWizard';\nimport {\n  Activity,\n  Moon,\n  Scale,\n  Utensils,\n  Dumbbell,\n  Brain,\n  Briefcase,\n  Heart,\n  Home,\n  Coffee,\n  Wind,\n  LogOut,\n  Sparkles,\n} from 'lucide-react';\nimport { getTodayISO } from '@/lib/dateUtils';\n\ninterface DailyAnalytics {\n  date: string;\n  sleepHours: number;\n  calories: number;\n  workouts: number;\n  weight: number | null;\n  scoreSmall: number;\n  kcalGoal: number;\n}\n\ninterface Streaks {\n  greenDays: number;\n  onTrackDays: number;\n}\n\nexport default function Today() {\n  const { user, isLoading, isAuthenticated } = useAuth();\n  const { toast } = useToast();\n  const today = getTodayISO();\n  const [showWizard, setShowWizard] = useState(false);\n\n  // Redirect unauthorized users\n  useEffect(() => {\n    if (!isLoading && !isAuthenticated) {\n      toast({\n        title: 'Unauthorized',\n        description: 'You are logged out. Logging in again...',\n        variant: 'destructive',\n      });\n      setTimeout(() => {\n        window.location.href = '/api/login';\n      }, 500);\n    }\n  }, [isAuthenticated, isLoading, toast]);\n\n  // Fetch today's analytics\n  const { data: dailyAnalytics } = useQuery<DailyAnalytics>({\n    queryKey: ['/api/analytics/daily', today],\n    enabled: isAuthenticated,\n  });\n\n  // Fetch current streaks\n  const { data: streaks } = useQuery<Streaks>({\n    queryKey: ['/api/streaks/current'],\n    enabled: isAuthenticated,\n  });\n\n  // Auto-show wizard on first visit of the day\n  useEffect(() => {\n    if (isAuthenticated && dailyAnalytics) {\n      const lastCheckInDate = localStorage.getItem('lastCheckInDate');\n      const hasCompletedToday = localStorage.getItem('completedCheckIn_' + today);\n      \n      // Show wizard if:\n      // 1. Haven't seen it today\n      // 2. No data logged yet (scoreSmall is 0)\n      if (!hasCompletedToday && dailyAnalytics.scoreSmall === 0 && lastCheckInDate !== today) {\n        setShowWizard(true);\n      }\n    }\n  }, [isAuthenticated, dailyAnalytics, today]);\n\n  const handleWizardClose = () => {\n    setShowWizard(false);\n    localStorage.setItem('completedCheckIn_' + today, 'true');\n    localStorage.setItem('lastCheckInDate', today);\n  };\n\n  if (isLoading || !isAuthenticated) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-pulse text-muted-foreground\">Loading...</div>\n      </div>\n    );\n  }\n\n  const greenStreak = streaks?.greenDays || 0;\n  const onTrackStreak = streaks?.onTrackDays || 0;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Daily Check-In Wizard */}\n      <DailyCheckInWizard\n        isOpen={showWizard}\n        onClose={handleWizardClose}\n        userId={user?.id || ''}\n        userFirstName={user?.firstName ?? undefined}\n      />\n      {/* Header */}\n      <header className=\"border-b sticky top-0 bg-background/95 backdrop-blur z-50\">\n        <div className=\"max-w-6xl mx-auto px-4 py-4 flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <Activity className=\"h-6 w-6 text-primary\" />\n            <h1 className=\"text-xl font-bold\">PBJ Lyfe</h1>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Button\n              variant=\"default\"\n              size=\"sm\"\n              onClick={() => setShowWizard(true)}\n              data-testid=\"button-open-checkin\"\n            >\n              <Sparkles className=\"h-4 w-4 mr-2\" />\n              Daily Check-In\n            </Button>\n            <ThemeToggle />\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => (window.location.href = '/api/logout')}\n              data-testid=\"button-logout\"\n            >\n              <LogOut className=\"h-4 w-4 mr-2\" />\n              Log Out\n            </Button>\n          </div>\n        </div>\n      </header>\n      {/* Welcome Message */}\n      <div className=\"max-w-6xl mx-auto px-4 py-8\">\n        <div className=\"mb-8\">\n          <h2 className=\"text-3xl font-bold mb-2\">\n            Welcome back, {user?.firstName || 'there'}!\n          </h2>\n          <p className=\"text-muted-foreground\">\n            Today Date: {new Date().toLocaleDateString('en-US', { \n              weekday: 'long',\n              month: 'long', \n              day: 'numeric' \n            })}\n          </p>\n        </div>\n\n        {/* Lyfe Tracking - Quick Access Row */}\n        <div className=\"mb-8\">\n          <h3 className=\"text-2xl font-semibold text-center mb-6\">How's Lyfe?</h3>\n          <div className=\"grid grid-cols-7 gap-3\">\n            <LifeButton icon={Brain} label=\"Mental\" href=\"/mental\" />\n            <LifeButton icon={Moon} label=\"Dreams\" href=\"/dreams\" />\n            <LifeButton icon={Briefcase} label=\"Work\" href=\"/work\" />\n            <LifeButton icon={Wind} label=\"Meditation\" href=\"/meditation\" />\n            <LifeButton icon={Heart} label=\"Social\" href=\"/social\" />\n            <LifeButton icon={Home} label=\"Hobbies\" href=\"/hobbies\" />\n            <LifeButton icon={Coffee} label=\"Recovery\" href=\"/recovery\" />\n          </div>\n        </div>\n\n        {/* Streak Overview */}\n        <div className=\"mb-8 p-8 rounded-xl border bg-card\">\n          <div className=\"text-center\">\n            {greenStreak > 0 ? (\n              <>\n                <p className=\"text-5xl font-bold text-green-600 dark:text-green-400 mb-2\">\n                  {greenStreak} {greenStreak === 1 ? 'Day' : 'Days'}\n                </p>\n                <p className=\"text-xl font-semibold uppercase tracking-wide text-green-600 dark:text-green-400 mb-2\">\n                  GREEN STREAK\n                </p>\n                <p className=\"text-sm text-muted-foreground mb-3\">\n                  You're doing great!\n                </p>\n                <p className=\"text-base font-semibold text-yellow-600 dark:text-yellow-400\">\n                  Overall Streak {greenStreak + onTrackStreak} {greenStreak + onTrackStreak === 1 ? 'Day' : 'Days'}\n                </p>\n              </>\n            ) : onTrackStreak > 0 ? (\n              <>\n                <p className=\"text-5xl font-bold text-yellow-600 dark:text-yellow-400 mb-2\">\n                  {onTrackStreak} {onTrackStreak === 1 ? 'Day' : 'Days'}\n                </p>\n                <p className=\"text-xl font-semibold uppercase tracking-wide text-yellow-600 dark:text-yellow-400 mb-2\">\n                  ACTIVE STREAK\n                </p>\n                <p className=\"text-sm text-muted-foreground\">\n                  Don't even think about falling off. Look how far you've come!\n                </p>\n              </>\n            ) : (\n              <>\n                <p className=\"text-5xl font-bold text-red-600 dark:text-red-400 mb-2\">\n                  0 Days\n                </p>\n                <p className=\"text-xl font-semibold uppercase tracking-wide text-red-600 dark:text-red-400 mb-2\">\n                  NO ACTIVE STREAK\n                </p>\n                <p className=\"text-sm text-muted-foreground\">\n                  You said \"better.\" Time to mean it.\n                </p>\n              </>\n            )}\n          </div>\n        </div>\n\n        {/* Main Dashboard Cards */}\n        <div className=\"grid md:grid-cols-2 gap-6\">\n          {/* Sleep Card */}\n          <DashboardCard\n            title=\"Sleep\"\n            description=\"Log your sleep sessions\"\n            actionLabel=\"Log\"\n            actionHref=\"/sleep\"\n            testId=\"card-sleep\"\n          >\n            {dailyAnalytics?.sleepHours ? (\n              <div className=\"space-y-2\">\n                <p className=\"text-3xl font-bold\">{dailyAnalytics.sleepHours.toFixed(1)}h</p>\n                <p className=\"text-sm text-muted-foreground\">\n                  {dailyAnalytics.sleepHours >= 6 ? '✓ Goal met' : 'Need 6+ hours'}\n                </p>\n              </div>\n            ) : (\n              <EmptyState\n                icon={Moon}\n                title=\"No sleep logged\"\n                description=\"Track your sleep to build your streak\"\n              />\n            )}\n          </DashboardCard>\n\n          {/* Weigh-In Card */}\n          <DashboardCard\n            title=\"Weight\"\n            description=\"Track your body metrics\"\n            actionLabel=\"Log\"\n            actionHref=\"/weight\"\n            testId=\"card-weight\"\n          >\n            {dailyAnalytics?.weight ? (\n              <div className=\"space-y-2\">\n                <p className=\"text-3xl font-bold\">{Math.round(dailyAnalytics.weight)} lbs</p>\n                <p className=\"text-sm text-muted-foreground\">\n                  {dailyAnalytics.weight > 0 ? 'Logged today' : ''}\n                </p>\n              </div>\n            ) : (\n              <EmptyState\n                icon={Scale}\n                title=\"No weight logged today\"\n                description=\"Log your morning weight for trend tracking\"\n              />\n            )}\n          </DashboardCard>\n\n          {/* Calories Card */}\n          <DashboardCard\n            title=\"Calories & Meals\"\n            description=\"Track your daily nutrition\"\n            actionLabel=\"Add Meal\"\n            actionHref=\"/meals\"\n            testId=\"card-calories\"\n          >\n            {dailyAnalytics?.calories ? (\n              <div className=\"space-y-2\">\n                <p className=\"text-3xl font-bold\">{dailyAnalytics.calories} cal</p>\n                <p className=\"text-sm text-muted-foreground\">\n                  {dailyAnalytics.scoreSmall >= 2 ? '✓ On track' : 'Keep logging meals'}\n                </p>\n              </div>\n            ) : (\n              <EmptyState\n                icon={Utensils}\n                title=\"No meals logged\"\n                description=\"Add your meals to track calories\"\n              />\n            )}\n          </DashboardCard>\n\n          {/* Workout Card */}\n          <DashboardCard\n            title=\"Workouts\"\n            description=\"Log your exercise sessions\"\n            actionLabel=\"Log\"\n            actionHref=\"/workouts\"\n            testId=\"card-workout\"\n          >\n            {dailyAnalytics?.workouts ? (\n              <div className=\"space-y-2\">\n                <p className=\"text-3xl font-bold\">✓ Logged</p>\n                <p className=\"text-sm text-muted-foreground\">\n                  {dailyAnalytics.workouts} {dailyAnalytics.workouts === 1 ? 'session' : 'sessions'} today\n                </p>\n              </div>\n            ) : (\n              <EmptyState\n                icon={Dumbbell}\n                title=\"No workout logged\"\n                description=\"Check in when you start your workout\"\n              />\n            )}\n          </DashboardCard>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction LifeButton({ icon: Icon, label, href }: { icon: any; label: string; href: string }) {\n  return (\n    <a href={href} data-testid={`link-${label.toLowerCase()}`}>\n      <Button\n        variant=\"outline\"\n        className=\"w-full h-16 flex-col gap-1 hover-elevate\"\n      >\n        <Icon className=\"h-4 w-4\" />\n        <span className=\"text-xs font-medium\">{label}</span>\n      </Button>\n    </a>\n  );\n}\n","size_bytes":11667},"client/src/hooks/useAuth.ts":{"content":"// Reference: Replit Auth blueprint\nimport { useQuery } from \"@tanstack/react-query\";\nimport type { User } from \"@shared/schema\";\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery<User>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}\n","size_bytes":343},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/pages/hobbies.tsx":{"content":"// PBJ Health - Hobbies Page\nimport { useAuth } from '@/hooks/useAuth';\nimport { DashboardCard } from '@/components/DashboardCard';\nimport { Button } from '@/components/ui/button';\nimport { ArrowLeft } from 'lucide-react';\nimport { Link } from 'wouter';\n\nexport default function Hobbies() {\n  const { isAuthenticated } = useAuth();\n\n  if (!isAuthenticated) return null;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b sticky top-0 bg-background/95 backdrop-blur z-50\">\n        <div className=\"max-w-2xl mx-auto px-4 py-4\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Today\n            </Button>\n          </Link>\n        </div>\n      </header>\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\n        <h1 className=\"text-3xl font-bold mb-8\">Hobbies</h1>\n        <DashboardCard title=\"Track Your Hobbies\">\n          <p className=\"text-muted-foreground\">\n            Track time spent on hobbies like guitar, reading, coding, etc.\n          </p>\n        </DashboardCard>\n      </div>\n    </div>\n  );\n}\n","size_bytes":1153},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"server/pbj-db.ts":{"content":"// server/pbj-db.ts\nimport Database from \"better-sqlite3\";\n\n// creates/opens pbj.sqlite at repo root\nexport const db = new Database(\"pbj.sqlite\");\ndb.pragma(\"foreign_keys = ON\");\n\n// idempotent schema: safe to run every boot\ndb.exec(`\ncreate table if not exists sleep_sessions (\n  id text primary key,\n  start_at text not null,\n  end_at   text not null,\n  duration_min integer not null,\n  notes text\n);\ncreate table if not exists body_metrics (\n  id text primary key,\n  date text not null,\n  weight_kg real not null\n);\ncreate table if not exists meals (\n  id text primary key,\n  date text not null,\n  calories integer not null,\n  notes text\n);\ncreate table if not exists workouts (\n  id text primary key,\n  date text not null,\n  start_at text,\n  end_at text,\n  duration_min integer not null default 0,\n  notes text\n);\ncreate table if not exists analytics_daily (\n  date text primary key,\n  sleep_min integer not null default 0,\n  kcal_intake integer not null default 0,\n  kcal_goal integer not null default 1700,\n  gym_duration_min integer not null default 0,\n  color text not null default 'red'\n);\n`);\n","size_bytes":1103},"client/src/components/DailyCheckInWizard.tsx":{"content":"// PBJ Health - Daily Check-In Wizard\n// Guided morning/afternoon flow for logging all daily health metrics\nimport { useState, useEffect } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { z } from 'zod';\nimport { useQuery, useMutation } from '@tanstack/react-query';\nimport { apiRequest, queryClient } from '@/lib/queryClient';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group';\nimport { Progress } from '@/components/ui/progress';\nimport { useToast } from '@/hooks/use-toast';\nimport {\n  Brain,\n  Moon,\n  Dumbbell,\n  Scale,\n  Wind,\n  Heart,\n  Home,\n  Coffee,\n  ChevronRight,\n  ChevronLeft,\n  Check,\n  Plus,\n  Trash2,\n} from 'lucide-react';\nimport { getTodayISO, getYesterdayISO } from '@/lib/dateUtils';\n\ninterface DailyCheckInWizardProps {\n  isOpen: boolean;\n  onClose: () => void;\n  userId: string;\n  userFirstName?: string;\n}\n\n// Workout types\ninterface StrengthExercise {\n  exercise: string;\n  weight: string;\n  reps: string;\n}\n\ninterface CardioActivity {\n  type: string;\n  duration: string;\n}\n\ninterface WorkoutSession {\n  startTime: string;\n  endTime: string;\n  strength: StrengthExercise[];\n  cardio: CardioActivity[];\n}\n\n// Recovery types\ninterface DrugEntry {\n  drugName: string;\n  amount: string;\n  isPrescribed: boolean;\n}\n\ninterface WithdrawalEntry {\n  drugName: string;\n  symptoms: string;\n}\n\n// Form schema for all steps combined\nconst checkInSchema = z.object({\n  // Step 1: Mental\n  mentalRating: z.enum(['great', 'ok', 'bad']),\n  mentalWhy: z.string().optional(),\n  \n  // Step 2: Sleep\n  sleepStart: z.string(),\n  sleepEnd: z.string(),\n  dreamType: z.enum(['dream', 'nightmare', 'none']),\n  dreamDescription: z.string(),\n  \n  // Step 3: Workout (managed separately with state)\n  didWorkout: z.boolean(),\n  workoutDate: z.string().optional(),\n  \n  // Step 4: Weight (image upload handled separately)\n  didWeighIn: z.boolean(),\n  weightLbs: z.number().optional(),\n  \n  // Step 5: Meditation\n  didMeditate: z.boolean(),\n  meditationMin: z.number().optional(),\n  \n  // Step 6 & 7: Yesterday's activities\n  yesterdayHobbies: z.string().optional(),\n  yesterdaySocial: z.string().optional(),\n  \n  // Step 8: Recovery (managed separately with state)\n  didUseDrugs: z.boolean(),\n  isInRecovery: z.boolean(),\n  \n  // Step 9: Calories\n  mealsDescription: z.string().optional(),\n  caloriesConsumed: z.number().optional(),\n  proteinG: z.number().optional(),\n  fatG: z.number().optional(),\n  carbsG: z.number().optional(),\n}).refine(\n  (data) => {\n    // If user worked out, workout date is required\n    if (data.didWorkout && (!data.workoutDate || data.workoutDate.trim() === '')) {\n      return false;\n    }\n    return true;\n  },\n  {\n    message: 'Workout date is required when you worked out',\n    path: ['workoutDate'],\n  }\n);\n\ntype CheckInFormData = z.infer<typeof checkInSchema>;\n\nexport function DailyCheckInWizard({ isOpen, onClose, userId, userFirstName }: DailyCheckInWizardProps) {\n  const [currentStep, setCurrentStep] = useState(1);\n  const [meditationTimeLeft, setMeditationTimeLeft] = useState(300); // 5 minutes\n  const [isMeditating, setIsMeditating] = useState(false);\n  const [uploadedImage, setUploadedImage] = useState<string | null>(null);\n  \n  // Workout sessions state\n  const [workoutSessions, setWorkoutSessions] = useState<WorkoutSession[]>([\n    {\n      startTime: '',\n      endTime: '',\n      strength: [{ exercise: '', weight: '', reps: '' }],\n      cardio: [{ type: '', duration: '' }],\n    },\n  ]);\n  \n  // Drug tracking state\n  const [drugEntries, setDrugEntries] = useState<DrugEntry[]>([\n    { drugName: '', amount: '', isPrescribed: false },\n  ]);\n  \n  // Withdrawal tracking state\n  const [withdrawalEntries, setWithdrawalEntries] = useState<WithdrawalEntry[]>([\n    { drugName: '', symptoms: '' },\n  ]);\n  \n  // Calorie calculation state\n  const [isCalculatingCalories, setIsCalculatingCalories] = useState(false);\n  const [hasCalculated, setHasCalculated] = useState(false);\n  \n  const { toast } = useToast();\n  const today = getTodayISO();\n  const yesterday = getYesterdayISO();\n\n  // Get user profile to check if inRecovery and get calorie goal\n  const { data: profile } = useQuery<{ inRecovery?: boolean }>({\n    queryKey: ['/api/profile'],\n    enabled: isOpen,\n  });\n  \n  const { data: goals } = useQuery<{ kcalGoal?: number }>({\n    queryKey: ['/api/goals'],\n    enabled: isOpen,\n  });\n\n  const totalSteps = 10; // Now includes Calories (9) and Summary (10)\n  const greeting = new Date().getHours() < 12 ? 'Good Morning' : 'Good Afternoon';\n\n  const form = useForm<CheckInFormData>({\n    resolver: zodResolver(checkInSchema),\n    defaultValues: {\n      mentalRating: 'ok',\n      dreamType: 'none',\n      dreamDescription: 'N/A',\n      didWorkout: false,\n      didWeighIn: false,\n      didMeditate: false,\n      didUseDrugs: false,\n      isInRecovery: false,\n      mealsDescription: '',\n      caloriesConsumed: undefined,\n      proteinG: undefined,\n      fatG: undefined,\n      carbsG: undefined,\n    },\n  });\n\n  // Watch form values for conditional logic\n  const dreamType = form.watch('dreamType');\n  const didWorkout = form.watch('didWorkout');\n  const didWeighIn = form.watch('didWeighIn');\n  const didMeditate = form.watch('didMeditate');\n  const didUseDrugs = form.watch('didUseDrugs');\n  const isInRecovery = form.watch('isInRecovery');\n  const mealsDescription = form.watch('mealsDescription');\n  const caloriesConsumed = form.watch('caloriesConsumed');\n  \n  // Auto-set isInRecovery from profile\n  useEffect(() => {\n    if (profile?.inRecovery && !form.getValues('isInRecovery')) {\n      form.setValue('isInRecovery', true);\n    }\n  }, [profile, form]);\n  \n  // Function to calculate calories using OpenAI\n  const calculateCalories = async () => {\n    if (!mealsDescription || mealsDescription.trim() === '') {\n      toast({\n        title: 'No meal description',\n        description: 'Please describe what you ate/drank yesterday',\n        variant: 'destructive',\n      });\n      return;\n    }\n    \n    setIsCalculatingCalories(true);\n    try {\n      const response = await apiRequest('POST', '/api/calculate-calories', {\n        mealsDescription: mealsDescription,\n      });\n      \n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({ message: 'Unknown error' }));\n        console.error('API error:', errorData);\n        throw new Error(errorData.message || 'Failed to calculate calories');\n      }\n      \n      const data = await response.json();\n      \n      // Validate that all values are valid numbers\n      if (!data.calories || !data.protein || !data.fat || !data.carbs ||\n          isNaN(data.calories) || isNaN(data.protein) || isNaN(data.fat) || isNaN(data.carbs)) {\n        throw new Error('Invalid response from AI - missing or invalid nutritional data');\n      }\n      \n      form.setValue('caloriesConsumed', Math.round(data.calories));\n      form.setValue('proteinG', Math.round(data.protein));\n      form.setValue('fatG', Math.round(data.fat));\n      form.setValue('carbsG', Math.round(data.carbs));\n      setHasCalculated(true);\n      \n      toast({\n        title: 'Calories Calculated',\n        description: `Estimated ${data.calories} calories from your meals`,\n      });\n    } catch (error) {\n      console.error('Error calculating calories:', error);\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error occurred';\n      toast({\n        title: 'Calculation Failed',\n        description: `Could not calculate calories: ${errorMessage}. Please enter manually.`,\n        variant: 'destructive',\n      });\n    } finally {\n      setIsCalculatingCalories(false);\n    }\n  };\n\n  // Auto-fill dream description\n  useEffect(() => {\n    if (dreamType === 'none') {\n      form.setValue('dreamDescription', 'N/A');\n    } else if (!form.getValues('dreamDescription') || form.getValues('dreamDescription') === 'N/A') {\n      form.setValue('dreamDescription', '');\n    }\n  }, [dreamType, form]);\n\n  // Meditation timer\n  useEffect(() => {\n    if (isMeditating && meditationTimeLeft > 0) {\n      const timer = setTimeout(() => setMeditationTimeLeft(meditationTimeLeft - 1), 1000);\n      return () => clearTimeout(timer);\n    } else if (meditationTimeLeft === 0) {\n      setIsMeditating(false);\n      toast({\n        title: 'Meditation Complete',\n        description: '5 minutes of mindfulness completed!',\n      });\n      form.setValue('meditationMin', 5);\n      setCurrentStep(currentStep + 1);\n    }\n  }, [isMeditating, meditationTimeLeft, currentStep, form, toast]);\n\n  // Submit all data\n  const submitCheckIn = useMutation({\n    mutationFn: async (data: CheckInFormData) => {\n      // Submit mental health\n      await apiRequest('POST', '/api/mental', {\n        date: today,\n        rating: data.mentalRating,\n        why: data.mentalWhy,\n      });\n\n      // Submit sleep\n      await apiRequest('POST', '/api/sleep', {\n        startAt: data.sleepStart,\n        endAt: data.sleepEnd,\n        dreamType: data.dreamType,\n        dreamDescription: data.dreamDescription,\n      });\n\n      // Submit workout sessions if applicable\n      if (data.didWorkout && data.workoutDate) {\n        for (const session of workoutSessions) {\n          // Only submit sessions with at least start/end time\n          if (session.startTime && session.endTime) {\n            // Combine date with times for full datetime\n            const startAt = `${data.workoutDate}T${session.startTime}`;\n            const endAt = `${data.workoutDate}T${session.endTime}`;\n            \n            // Collect all non-empty strength exercises\n            const exercises = session.strength\n              .filter(ex => ex.exercise.trim())\n              .map(ex => `${ex.exercise} - ${ex.weight} x ${ex.reps}`)\n              .concat(\n                session.cardio\n                  .filter(c => c.type.trim())\n                  .map(c => `${c.type} - ${c.duration}`)\n              );\n            \n            await apiRequest('POST', '/api/workouts', {\n              date: data.workoutDate,\n              startAt: startAt,\n              endAt: endAt,\n              exercises: exercises,\n            });\n          }\n        }\n      }\n\n      // Submit weight if provided (convert lbs to kg for storage)\n      if (data.didWeighIn && data.weightLbs) {\n        const weightKg = data.weightLbs * 0.453592; // Convert lbs to kg\n        await apiRequest('POST', '/api/weight', {\n          date: today,\n          weightKg: weightKg,\n        });\n      }\n\n      // Submit meditation if done\n      if (data.didMeditate && data.meditationMin) {\n        await apiRequest('POST', '/api/meditation', {\n          date: today,\n          durationMin: data.meditationMin,\n        });\n      }\n\n      // Submit yesterday's hobbies\n      if (data.yesterdayHobbies) {\n        await apiRequest('POST', '/api/hobbies', {\n          date: yesterday,\n          activities: data.yesterdayHobbies,\n        });\n      }\n\n      // Submit yesterday's social\n      if (data.yesterdaySocial) {\n        await apiRequest('POST', '/api/social', {\n          date: yesterday,\n          activity: data.yesterdaySocial,\n        });\n      }\n      \n      // Submit calories/meals if provided\n      if (data.caloriesConsumed) {\n        await apiRequest('POST', '/api/meals', {\n          date: yesterday,\n          calories: data.caloriesConsumed,\n          proteinG: data.proteinG,\n          fatG: data.fatG,\n          carbsG: data.carbsG,\n          notes: data.mealsDescription,\n        });\n      }\n\n      // Submit drug use logs if applicable\n      if (data.didUseDrugs) {\n        for (const entry of drugEntries) {\n          if (entry.drugName.trim()) {\n            await apiRequest('POST', '/api/recovery/drug-use', {\n              date: yesterday,\n              drugName: entry.drugName,\n              amount: entry.amount,\n              isPrescribed: entry.isPrescribed,\n            });\n          }\n        }\n      }\n      \n      // Submit withdrawal symptoms if applicable\n      if (data.isInRecovery) {\n        for (const entry of withdrawalEntries) {\n          if (entry.drugName.trim() && entry.symptoms.trim()) {\n            await apiRequest('POST', '/api/recovery/withdrawal', {\n              date: yesterday,\n              drugName: entry.drugName,\n              symptoms: entry.symptoms,\n            });\n          }\n        }\n      }\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/analytics/daily', today] });\n      queryClient.invalidateQueries({ queryKey: ['/api/streaks/current'] });\n      toast({\n        title: 'Check-In Complete!',\n        description: 'All your daily health data has been logged.',\n      });\n      onClose();\n    },\n    onError: (error) => {\n      toast({\n        title: 'Error',\n        description: 'Failed to save check-in data. Please try again.',\n        variant: 'destructive',\n      });\n      console.error(error);\n    },\n  });\n\n  const handleNext = async () => {\n    // Validate only the current step's fields\n    let fieldsToValidate: (keyof CheckInFormData)[] = [];\n    \n    if (currentStep === 1) {\n      fieldsToValidate = ['mentalRating', 'mentalWhy'];\n    } else if (currentStep === 2) {\n      fieldsToValidate = ['sleepStart', 'sleepEnd', 'dreamType', 'dreamDescription'];\n    } else if (currentStep === 3) {\n      fieldsToValidate = ['didWorkout', 'workoutDate'];\n      \n      // Additional validation for workout step\n      const didWorkoutValue = form.getValues('didWorkout');\n      if (didWorkoutValue) {\n        // Validate at least one session has both start and end times\n        const hasValidSession = workoutSessions.some(\n          session => session.startTime && session.endTime\n        );\n        \n        if (!hasValidSession) {\n          toast({\n            title: 'Missing session times',\n            description: 'Please fill in start and end times for at least one session',\n            variant: 'destructive',\n          });\n          return;\n        }\n      }\n    } else if (currentStep === 4) {\n      fieldsToValidate = ['didWeighIn'];\n      \n      // Additional validation for weight step - only require weight if user weighed in\n      const didWeighInValue = form.getValues('didWeighIn');\n      if (didWeighInValue) {\n        const weightLbs = form.getValues('weightLbs');\n        if (!weightLbs || weightLbs <= 0) {\n          toast({\n            title: 'Missing weight',\n            description: 'Please enter your weight in pounds',\n            variant: 'destructive',\n          });\n          return;\n        }\n      }\n    } else if (currentStep === 5) {\n      fieldsToValidate = ['didMeditate'];\n    } else if (currentStep === 6) {\n      // Step 6 (hobbies) - optional, no required validation\n      fieldsToValidate = [];\n    } else if (currentStep === 7) {\n      // Step 7 (social) - optional, no required validation\n      fieldsToValidate = [];\n    } else if (currentStep === 8) {\n      // Step 8 (recovery) - optional, no required validation\n      fieldsToValidate = [];\n    } else if (currentStep === 9) {\n      // Step 9 (meals/calories) - optional, no required validation\n      fieldsToValidate = [];\n    }\n\n    const isValid = await form.trigger(fieldsToValidate);\n    if (!isValid) {\n      return;\n    }\n\n    if (currentStep < totalSteps) {\n      setCurrentStep(currentStep + 1);\n    } else {\n      // Final step - submit everything\n      form.handleSubmit((data) => submitCheckIn.mutate(data))();\n    }\n  };\n\n  const handleBack = () => {\n    if (currentStep > 1) {\n      setCurrentStep(currentStep - 1);\n    }\n  };\n\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"text-2xl\">\n            {greeting}, How's Lyfe?\n          </DialogTitle>\n          <DialogDescription>\n            Complete your daily check-in to track yesterday's health journey\n          </DialogDescription>\n          <Progress value={(currentStep / totalSteps) * 100} className=\"mt-4\" />\n          <p className=\"text-sm text-muted-foreground mt-2\">\n            Step {currentStep} of {totalSteps}\n          </p>\n        </DialogHeader>\n\n        <form className=\"space-y-6 mt-6\">\n          {/* Step 1: Mental Health */}\n          {currentStep === 1 && (\n            <div className=\"space-y-4\" data-testid=\"step-mental\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <Brain className=\"h-6 w-6 text-primary\" />\n                <h3 className=\"text-lg font-semibold\">How would you describe your mental state yesterday?</h3>\n              </div>\n              \n              <div className=\"space-y-4\">\n                <Label>Mental state yesterday</Label>\n                <RadioGroup\n                  value={form.watch('mentalRating')}\n                  onValueChange={(value) => form.setValue('mentalRating', value as any)}\n                >\n                  <div className=\"flex items-center space-x-2\">\n                    <RadioGroupItem value=\"great\" id=\"great\" data-testid=\"radio-mental-great\" />\n                    <Label htmlFor=\"great\">Great</Label>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <RadioGroupItem value=\"ok\" id=\"ok\" data-testid=\"radio-mental-ok\" />\n                    <Label htmlFor=\"ok\">Ok</Label>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <RadioGroupItem value=\"bad\" id=\"bad\" data-testid=\"radio-mental-bad\" />\n                    <Label htmlFor=\"bad\">Bad</Label>\n                  </div>\n                </RadioGroup>\n\n                <div>\n                  <Label htmlFor=\"mental-why\">Why? (optional)</Label>\n                  <Textarea\n                    id=\"mental-why\"\n                    placeholder=\"Share what's on your mind...\"\n                    {...form.register('mentalWhy')}\n                    data-testid=\"textarea-mental-why\"\n                  />\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Step 2: Sleep */}\n          {currentStep === 2 && (\n            <div className=\"space-y-4\" data-testid=\"step-sleep\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <Moon className=\"h-6 w-6 text-primary\" />\n                <h3 className=\"text-lg font-semibold\">How did you sleep last night?</h3>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <Label htmlFor=\"sleep-start\">Went to bed</Label>\n                  <Input\n                    id=\"sleep-start\"\n                    type=\"datetime-local\"\n                    {...form.register('sleepStart')}\n                    data-testid=\"input-sleep-start-wizard\"\n                  />\n                </div>\n                <div>\n                  <Label htmlFor=\"sleep-end\">Woke up</Label>\n                  <Input\n                    id=\"sleep-end\"\n                    type=\"datetime-local\"\n                    {...form.register('sleepEnd')}\n                    data-testid=\"input-sleep-end-wizard\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"space-y-4\">\n                <Label>Did you have any dreams?</Label>\n                <RadioGroup\n                  value={dreamType}\n                  onValueChange={(value) => form.setValue('dreamType', value as any)}\n                >\n                  <div className=\"flex items-center space-x-2\">\n                    <RadioGroupItem value=\"dream\" id=\"dream\" data-testid=\"radio-dream\" />\n                    <Label htmlFor=\"dream\">Dream</Label>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <RadioGroupItem value=\"nightmare\" id=\"nightmare\" data-testid=\"radio-nightmare\" />\n                    <Label htmlFor=\"nightmare\">Nightmare</Label>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <RadioGroupItem value=\"none\" id=\"no-dream\" data-testid=\"radio-no-dream\" />\n                    <Label htmlFor=\"no-dream\">None</Label>\n                  </div>\n                </RadioGroup>\n\n                {dreamType !== 'none' && (\n                  <div>\n                    <Label htmlFor=\"dream-description\">Description</Label>\n                    <Textarea\n                      id=\"dream-description\"\n                      placeholder=\"Describe your dream...\"\n                      {...form.register('dreamDescription')}\n                      data-testid=\"textarea-dream-description\"\n                    />\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      Leave blank to auto-fill \"No Memory\"\n                    </p>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Step 3: Workout */}\n          {currentStep === 3 && (\n            <div className=\"space-y-6\" data-testid=\"step-workout\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <Dumbbell className=\"h-6 w-6 text-primary\" />\n                <h3 className=\"text-lg font-semibold\">Did you work out yesterday?</h3>\n              </div>\n\n              <RadioGroup\n                value={didWorkout ? 'yes' : 'no'}\n                onValueChange={(value) => form.setValue('didWorkout', value === 'yes')}\n              >\n                <div className=\"flex items-center space-x-2\">\n                  <RadioGroupItem value=\"yes\" id=\"workout-yes\" data-testid=\"radio-workout-yes\" />\n                  <Label htmlFor=\"workout-yes\">Yes</Label>\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  <RadioGroupItem value=\"no\" id=\"workout-no\" data-testid=\"radio-workout-no\" />\n                  <Label htmlFor=\"workout-no\">No</Label>\n                </div>\n              </RadioGroup>\n\n              {didWorkout && (\n                <div className=\"space-y-6 mt-4\">\n                  {/* Date field */}\n                  <div>\n                    <Label htmlFor=\"workout-date\">Date</Label>\n                    <Input\n                      id=\"workout-date\"\n                      type=\"date\"\n                      {...form.register('workoutDate')}\n                      data-testid=\"input-workout-date\"\n                      className={form.formState.errors.workoutDate ? 'border-destructive' : ''}\n                    />\n                    {form.formState.errors.workoutDate && (\n                      <p className=\"text-sm text-destructive mt-1\">\n                        {form.formState.errors.workoutDate.message}\n                      </p>\n                    )}\n                  </div>\n\n                  {/* Workout Sessions */}\n                  {workoutSessions.map((session, sessionIdx) => (\n                    <div key={sessionIdx} className=\"space-y-4 p-4 border rounded-lg\">\n                      <h4 className=\"font-semibold\">Session {sessionIdx + 1}</h4>\n                      \n                      {/* Session Time */}\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <div>\n                          <Label htmlFor={`session-${sessionIdx}-start`}>Start Time</Label>\n                          <Input\n                            id={`session-${sessionIdx}-start`}\n                            type=\"time\"\n                            value={session.startTime}\n                            onChange={(e) => {\n                              const newSessions = [...workoutSessions];\n                              newSessions[sessionIdx].startTime = e.target.value;\n                              setWorkoutSessions(newSessions);\n                            }}\n                            data-testid={`input-session-${sessionIdx}-start`}\n                          />\n                        </div>\n                        <div>\n                          <Label htmlFor={`session-${sessionIdx}-end`}>End Time</Label>\n                          <Input\n                            id={`session-${sessionIdx}-end`}\n                            type=\"time\"\n                            value={session.endTime}\n                            onChange={(e) => {\n                              const newSessions = [...workoutSessions];\n                              newSessions[sessionIdx].endTime = e.target.value;\n                              setWorkoutSessions(newSessions);\n                            }}\n                            data-testid={`input-session-${sessionIdx}-end`}\n                          />\n                        </div>\n                      </div>\n\n                      {/* Workouts - Two Columns */}\n                      <div>\n                        <Label className=\"text-base font-semibold mb-2\">Workouts</Label>\n                        <div className=\"grid grid-cols-2 gap-4 mt-2\">\n                          {/* Column 1: Strength */}\n                          <div className=\"space-y-2\">\n                            <h5 className=\"font-medium text-sm\">Strength</h5>\n                            {session.strength.map((exercise, exIdx) => (\n                              <div key={exIdx} className=\"flex gap-2 items-start\">\n                                <div className=\"flex-1 space-y-1\">\n                                  <Input\n                                    placeholder=\"Exercise\"\n                                    value={exercise.exercise}\n                                    onChange={(e) => {\n                                      const newSessions = [...workoutSessions];\n                                      newSessions[sessionIdx].strength[exIdx].exercise = e.target.value;\n                                      setWorkoutSessions(newSessions);\n                                    }}\n                                    data-testid={`input-strength-${sessionIdx}-${exIdx}-exercise`}\n                                    className=\"text-sm\"\n                                  />\n                                  <div className=\"flex gap-1\">\n                                    <Input\n                                      placeholder=\"Weight\"\n                                      value={exercise.weight}\n                                      onChange={(e) => {\n                                        const newSessions = [...workoutSessions];\n                                        newSessions[sessionIdx].strength[exIdx].weight = e.target.value;\n                                        setWorkoutSessions(newSessions);\n                                      }}\n                                      data-testid={`input-strength-${sessionIdx}-${exIdx}-weight`}\n                                      className=\"text-sm\"\n                                    />\n                                    <Input\n                                      placeholder=\"Reps\"\n                                      value={exercise.reps}\n                                      onChange={(e) => {\n                                        const newSessions = [...workoutSessions];\n                                        newSessions[sessionIdx].strength[exIdx].reps = e.target.value;\n                                        setWorkoutSessions(newSessions);\n                                      }}\n                                      data-testid={`input-strength-${sessionIdx}-${exIdx}-reps`}\n                                      className=\"text-sm\"\n                                    />\n                                  </div>\n                                </div>\n                                {session.strength.length > 1 && (\n                                  <Button\n                                    type=\"button\"\n                                    variant=\"ghost\"\n                                    size=\"icon\"\n                                    onClick={() => {\n                                      const newSessions = [...workoutSessions];\n                                      newSessions[sessionIdx].strength.splice(exIdx, 1);\n                                      setWorkoutSessions(newSessions);\n                                    }}\n                                    data-testid={`button-remove-strength-${sessionIdx}-${exIdx}`}\n                                  >\n                                    <Trash2 className=\"h-4 w-4\" />\n                                  </Button>\n                                )}\n                              </div>\n                            ))}\n                            <Button\n                              type=\"button\"\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => {\n                                const newSessions = [...workoutSessions];\n                                newSessions[sessionIdx].strength.push({ exercise: '', weight: '', reps: '' });\n                                setWorkoutSessions(newSessions);\n                              }}\n                              data-testid={`button-add-strength-${sessionIdx}`}\n                              className=\"w-full\"\n                            >\n                              <Plus className=\"h-4 w-4 mr-1\" /> Add Exercise\n                            </Button>\n                          </div>\n\n                          {/* Column 2: Cardio */}\n                          <div className=\"space-y-2\">\n                            <h5 className=\"font-medium text-sm\">Cardio</h5>\n                            {session.cardio.map((cardio, cardioIdx) => (\n                              <div key={cardioIdx} className=\"flex gap-2 items-center\">\n                                <Input\n                                  placeholder=\"Type\"\n                                  value={cardio.type}\n                                  onChange={(e) => {\n                                    const newSessions = [...workoutSessions];\n                                    newSessions[sessionIdx].cardio[cardioIdx].type = e.target.value;\n                                    setWorkoutSessions(newSessions);\n                                  }}\n                                  data-testid={`input-cardio-${sessionIdx}-${cardioIdx}-type`}\n                                  className=\"text-sm flex-1\"\n                                />\n                                <Input\n                                  placeholder=\"Duration\"\n                                  value={cardio.duration}\n                                  onChange={(e) => {\n                                    const newSessions = [...workoutSessions];\n                                    newSessions[sessionIdx].cardio[cardioIdx].duration = e.target.value;\n                                    setWorkoutSessions(newSessions);\n                                  }}\n                                  data-testid={`input-cardio-${sessionIdx}-${cardioIdx}-duration`}\n                                  className=\"text-sm flex-1\"\n                                />\n                                {session.cardio.length > 1 && (\n                                  <Button\n                                    type=\"button\"\n                                    variant=\"ghost\"\n                                    size=\"icon\"\n                                    onClick={() => {\n                                      const newSessions = [...workoutSessions];\n                                      newSessions[sessionIdx].cardio.splice(cardioIdx, 1);\n                                      setWorkoutSessions(newSessions);\n                                    }}\n                                    data-testid={`button-remove-cardio-${sessionIdx}-${cardioIdx}`}\n                                  >\n                                    <Trash2 className=\"h-4 w-4\" />\n                                  </Button>\n                                )}\n                              </div>\n                            ))}\n                            <Button\n                              type=\"button\"\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => {\n                                const newSessions = [...workoutSessions];\n                                newSessions[sessionIdx].cardio.push({ type: '', duration: '' });\n                                setWorkoutSessions(newSessions);\n                              }}\n                              data-testid={`button-add-cardio-${sessionIdx}`}\n                              className=\"w-full\"\n                            >\n                              <Plus className=\"h-4 w-4 mr-1\" /> Add Cardio\n                            </Button>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n\n                  {/* Add Another Session */}\n                  <div className=\"space-y-2\">\n                    <p className=\"text-sm font-medium\">Add another session?</p>\n                    <div className=\"flex gap-2\">\n                      <Button\n                        type=\"button\"\n                        variant=\"outline\"\n                        onClick={() => {\n                          setWorkoutSessions([\n                            ...workoutSessions,\n                            {\n                              startTime: '',\n                              endTime: '',\n                              strength: [{ exercise: '', weight: '', reps: '' }],\n                              cardio: [{ type: '', duration: '' }],\n                            },\n                          ]);\n                        }}\n                        data-testid=\"button-add-session\"\n                      >\n                        <Plus className=\"h-4 w-4 mr-1\" /> Yes, Add Session\n                      </Button>\n                      {workoutSessions.length > 1 && (\n                        <Button\n                          type=\"button\"\n                          variant=\"ghost\"\n                          onClick={() => {\n                            const newSessions = [...workoutSessions];\n                            newSessions.pop();\n                            setWorkoutSessions(newSessions);\n                          }}\n                          data-testid=\"button-remove-last-session\"\n                        >\n                          <Trash2 className=\"h-4 w-4 mr-1\" /> Remove Last Session\n                        </Button>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Step 4: Weight (with image upload placeholder) */}\n          {currentStep === 4 && (\n            <div className=\"space-y-4\" data-testid=\"step-weight\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <Scale className=\"h-6 w-6 text-primary\" />\n                <h3 className=\"text-lg font-semibold\">Did you weigh in yesterday?</h3>\n              </div>\n\n              <RadioGroup\n                value={didWeighIn ? 'yes' : 'no'}\n                onValueChange={(value) => form.setValue('didWeighIn', value === 'yes')}\n              >\n                <div className=\"flex items-center space-x-2\">\n                  <RadioGroupItem value=\"yes\" id=\"weighin-yes\" data-testid=\"radio-weighin-yes\" />\n                  <Label htmlFor=\"weighin-yes\">Yes</Label>\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  <RadioGroupItem value=\"no\" id=\"weighin-no\" data-testid=\"radio-weighin-no\" />\n                  <Label htmlFor=\"weighin-no\">No</Label>\n                </div>\n              </RadioGroup>\n\n              {didWeighIn && (\n                <div className=\"space-y-4 mt-4\">\n                  <div>\n                    <Label htmlFor=\"weight-upload\">Upload Body Metrics Screenshot (optional)</Label>\n                    <Input\n                      id=\"weight-upload\"\n                      type=\"file\"\n                      accept=\"image/*\"\n                      onChange={async (e) => {\n                        const file = e.target.files?.[0];\n                        if (file) {\n                          const reader = new FileReader();\n                          reader.onloadend = () => {\n                            setUploadedImage(reader.result as string);\n                            // TODO: Call OpenAI Vision API to analyze image\n                            toast({\n                              title: 'Image uploaded',\n                              description: 'AI analysis will be implemented soon',\n                            });\n                          };\n                          reader.readAsDataURL(file);\n                        }\n                      }}\n                      data-testid=\"input-weight-image\"\n                    />\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      Or enter manually below\n                    </p>\n                  </div>\n\n                  <div>\n                    <Label htmlFor=\"weight-lbs\">Weight (lbs)</Label>\n                    <Input\n                      id=\"weight-lbs\"\n                      type=\"number\"\n                      step=\"0.1\"\n                      placeholder=\"155.5\"\n                      {...form.register('weightLbs', { valueAsNumber: true })}\n                      data-testid=\"input-weight-lbs-wizard\"\n                    />\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Step 5: Meditation */}\n          {currentStep === 5 && (\n            <div className=\"space-y-4\" data-testid=\"step-meditation\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <Wind className=\"h-6 w-6 text-primary\" />\n                <h3 className=\"text-lg font-semibold\">Did you meditate yesterday?</h3>\n              </div>\n\n              {!isMeditating ? (\n                <>\n                  <RadioGroup\n                    value={didMeditate ? 'yes' : 'no'}\n                    onValueChange={(value) => {\n                      const meditated = value === 'yes';\n                      form.setValue('didMeditate', meditated);\n                      if (meditated) {\n                        form.setValue('meditationMin', 5);\n                      }\n                    }}\n                  >\n                    <div className=\"flex items-center space-x-2\">\n                      <RadioGroupItem value=\"yes\" id=\"meditate-yes\" data-testid=\"radio-meditate-yes\" />\n                      <Label htmlFor=\"meditate-yes\">Yes</Label>\n                    </div>\n                    <div className=\"flex items-center space-x-2\">\n                      <RadioGroupItem value=\"no\" id=\"meditate-no\" data-testid=\"radio-meditate-no\" />\n                      <Label htmlFor=\"meditate-no\">No</Label>\n                    </div>\n                  </RadioGroup>\n\n                  {!didMeditate && (\n                    <Button\n                      type=\"button\"\n                      variant=\"outline\"\n                      className=\"w-full\"\n                      onClick={() => {\n                        setIsMeditating(true);\n                        setMeditationTimeLeft(300);\n                      }}\n                      data-testid=\"button-start-meditation\"\n                    >\n                      Start 5-Minute Meditation Timer\n                    </Button>\n                  )}\n                </>\n              ) : (\n                <div className=\"text-center space-y-4\">\n                  <div className=\"text-6xl font-bold text-primary\">\n                    {formatTime(meditationTimeLeft)}\n                  </div>\n                  <p className=\"text-muted-foreground\">Breathe deeply and relax...</p>\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => {\n                      setIsMeditating(false);\n                      setMeditationTimeLeft(300);\n                    }}\n                    data-testid=\"button-stop-meditation\"\n                  >\n                    Stop Timer\n                  </Button>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Step 6: Yesterday's Hobbies */}\n          {currentStep === 6 && (\n            <div className=\"space-y-4\" data-testid=\"step-hobbies\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <Home className=\"h-6 w-6 text-primary\" />\n                <h3 className=\"text-lg font-semibold\">What hobbies did you do yesterday?</h3>\n              </div>\n\n              <div>\n                <Textarea\n                  placeholder=\"Reading, guitar practice, cooking...\"\n                  {...form.register('yesterdayHobbies')}\n                  data-testid=\"textarea-hobbies\"\n                />\n              </div>\n            </div>\n          )}\n\n          {/* Step 7: Yesterday's Social */}\n          {currentStep === 7 && (\n            <div className=\"space-y-4\" data-testid=\"step-social\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <Heart className=\"h-6 w-6 text-primary\" />\n                <h3 className=\"text-lg font-semibold\">What social activities did you do yesterday?</h3>\n              </div>\n\n              <div>\n                <Textarea\n                  placeholder=\"Dinner with friends, family call, game night...\"\n                  {...form.register('yesterdaySocial')}\n                  data-testid=\"textarea-social\"\n                />\n              </div>\n            </div>\n          )}\n\n          {/* Step 9: Calories */}\n          {currentStep === 9 && (\n            <div className=\"space-y-6\" data-testid=\"step-calories\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <Scale className=\"h-6 w-6 text-primary\" />\n                <h3 className=\"text-lg font-semibold\">What did you eat/drink yesterday?</h3>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Meals & Beverages</Label>\n                <Textarea\n                  placeholder=\"Breakfast: 2 eggs, toast, coffee&#10;Lunch: Chicken salad, water&#10;Dinner: Pasta, wine&#10;Snacks: Apple, protein bar\"\n                  {...form.register('mealsDescription')}\n                  data-testid=\"textarea-meals\"\n                  rows={6}\n                />\n              </div>\n\n              {/* AI Calculate Button */}\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={calculateCalories}\n                disabled={isCalculatingCalories || !mealsDescription}\n                data-testid=\"button-calculate-calories\"\n                className=\"w-full\"\n              >\n                {isCalculatingCalories ? 'Calculating...' : 'Calculate with AI'}\n              </Button>\n\n              {/* Calorie & Macro Fields */}\n              <div className=\"grid grid-cols-2 gap-4 p-4 bg-muted/30 rounded-lg border\">\n                <div className=\"col-span-2 space-y-2\">\n                  <Label>Calories Consumed</Label>\n                  <Input\n                    type=\"number\"\n                    placeholder=\"e.g., 2000\"\n                    {...form.register('caloriesConsumed', { valueAsNumber: true })}\n                    data-testid=\"input-calories\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Protein (g)</Label>\n                  <Input\n                    type=\"number\"\n                    placeholder=\"e.g., 120\"\n                    {...form.register('proteinG', { valueAsNumber: true })}\n                    data-testid=\"input-protein\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Fat (g)</Label>\n                  <Input\n                    type=\"number\"\n                    placeholder=\"e.g., 60\"\n                    {...form.register('fatG', { valueAsNumber: true })}\n                    data-testid=\"input-fat\"\n                  />\n                </div>\n                <div className=\"col-span-2 space-y-2\">\n                  <Label>Carbs (g)</Label>\n                  <Input\n                    type=\"number\"\n                    placeholder=\"e.g., 200\"\n                    {...form.register('carbsG', { valueAsNumber: true })}\n                    data-testid=\"input-carbs\"\n                  />\n                </div>\n              </div>\n\n              {/* Net Calories Info */}\n              {caloriesConsumed && goals?.kcalGoal && (\n                <div className=\"p-4 bg-primary/10 rounded-lg border border-primary/20\">\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <span className=\"text-sm font-medium\">Calorie Target:</span>\n                    <span className=\"text-sm\">{goals.kcalGoal} kcal</span>\n                  </div>\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <span className=\"text-sm font-medium\">Consumed:</span>\n                    <span className=\"text-sm\">{caloriesConsumed} kcal</span>\n                  </div>\n                  <div className=\"flex justify-between items-center font-semibold\">\n                    <span className=\"text-sm\">Status:</span>\n                    <span className={`text-sm ${caloriesConsumed <= goals.kcalGoal ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'}`}>\n                      {caloriesConsumed <= goals.kcalGoal ? 'Under Target ✓' : 'Over Target'}\n                    </span>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Step 8: Recovery */}\n          {currentStep === 8 && (\n            <div className=\"space-y-6\" data-testid=\"step-recovery\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <Coffee className=\"h-6 w-6 text-primary\" />\n                <h3 className=\"text-lg font-semibold\">Recovery Check-In</h3>\n              </div>\n\n              {/* Did you consume drugs yesterday? */}\n              <div className=\"space-y-2\">\n                <Label>Did you consume any drugs yesterday?</Label>\n                <div className=\"flex gap-4\">\n                  <Button\n                    type=\"button\"\n                    variant={didUseDrugs ? 'default' : 'outline'}\n                    onClick={() => form.setValue('didUseDrugs', true)}\n                    data-testid=\"button-drugs-yes\"\n                    className=\"flex-1\"\n                  >\n                    Yes\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    variant={!didUseDrugs ? 'default' : 'outline'}\n                    onClick={() => form.setValue('didUseDrugs', false)}\n                    data-testid=\"button-drugs-no\"\n                    className=\"flex-1\"\n                  >\n                    No\n                  </Button>\n                </div>\n              </div>\n\n              {/* Drug entries (if yes) */}\n              {didUseDrugs && (\n                <div className=\"space-y-4 p-4 bg-muted/30 rounded-lg border\">\n                  <h4 className=\"font-medium text-sm\">Drug Details</h4>\n                  {drugEntries.map((entry, idx) => (\n                    <div key={idx} className=\"space-y-3 p-3 bg-background rounded border\">\n                      <div className=\"space-y-2\">\n                        <Label>Drug Name</Label>\n                        <Input\n                          placeholder=\"e.g., Alcohol, Cannabis\"\n                          value={entry.drugName}\n                          onChange={(e) => {\n                            const newEntries = [...drugEntries];\n                            newEntries[idx].drugName = e.target.value;\n                            setDrugEntries(newEntries);\n                          }}\n                          data-testid={`input-drug-name-${idx}`}\n                        />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label>Amount</Label>\n                        <Input\n                          placeholder=\"e.g., 2 beers, 1 joint\"\n                          value={entry.amount}\n                          onChange={(e) => {\n                            const newEntries = [...drugEntries];\n                            newEntries[idx].amount = e.target.value;\n                            setDrugEntries(newEntries);\n                          }}\n                          data-testid={`input-drug-amount-${idx}`}\n                        />\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <input\n                          type=\"checkbox\"\n                          checked={entry.isPrescribed}\n                          onChange={(e) => {\n                            const newEntries = [...drugEntries];\n                            newEntries[idx].isPrescribed = e.target.checked;\n                            setDrugEntries(newEntries);\n                          }}\n                          data-testid={`checkbox-prescribed-${idx}`}\n                          className=\"h-4 w-4\"\n                        />\n                        <Label>Prescribed medication</Label>\n                        {drugEntries.length > 1 && (\n                          <Button\n                            type=\"button\"\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => {\n                              const newEntries = [...drugEntries];\n                              newEntries.splice(idx, 1);\n                              setDrugEntries(newEntries);\n                            }}\n                            data-testid={`button-remove-drug-${idx}`}\n                            className=\"ml-auto\"\n                          >\n                            <Trash2 className=\"h-4 w-4\" />\n                          </Button>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => {\n                      setDrugEntries([...drugEntries, { drugName: '', amount: '', isPrescribed: false }]);\n                    }}\n                    data-testid=\"button-add-drug\"\n                    className=\"w-full\"\n                  >\n                    <Plus className=\"h-4 w-4 mr-1\" /> Add Another Drug\n                  </Button>\n                </div>\n              )}\n\n              {/* Are you in recovery checkbox */}\n              <div className=\"flex items-center gap-2 p-3 bg-muted/20 rounded border\">\n                <input\n                  type=\"checkbox\"\n                  checked={isInRecovery}\n                  onChange={(e) => form.setValue('isInRecovery', e.target.checked)}\n                  data-testid=\"checkbox-in-recovery\"\n                  className=\"h-4 w-4\"\n                />\n                <Label>I am in recovery</Label>\n              </div>\n\n              {/* Withdrawal symptoms (if in recovery) */}\n              {isInRecovery && (\n                <div className=\"space-y-4 p-4 bg-muted/30 rounded-lg border\">\n                  <h4 className=\"font-medium text-sm\">Withdrawal Symptoms</h4>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Please describe any withdrawal symptoms you experienced yesterday\n                  </p>\n                  {withdrawalEntries.map((entry, idx) => (\n                    <div key={idx} className=\"space-y-3 p-3 bg-background rounded border\">\n                      <div className=\"space-y-2\">\n                        <Label>Drug Name</Label>\n                        <Input\n                          placeholder=\"e.g., Alcohol, Nicotine\"\n                          value={entry.drugName}\n                          onChange={(e) => {\n                            const newEntries = [...withdrawalEntries];\n                            newEntries[idx].drugName = e.target.value;\n                            setWithdrawalEntries(newEntries);\n                          }}\n                          data-testid={`input-withdrawal-drug-${idx}`}\n                        />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label>Symptoms</Label>\n                        <Textarea\n                          placeholder=\"Describe symptoms (e.g., headache, nausea, anxiety)\"\n                          value={entry.symptoms}\n                          onChange={(e) => {\n                            const newEntries = [...withdrawalEntries];\n                            newEntries[idx].symptoms = e.target.value;\n                            setWithdrawalEntries(newEntries);\n                          }}\n                          data-testid={`textarea-withdrawal-symptoms-${idx}`}\n                        />\n                      </div>\n                      {withdrawalEntries.length > 1 && (\n                        <Button\n                          type=\"button\"\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => {\n                            const newEntries = [...withdrawalEntries];\n                            newEntries.splice(idx, 1);\n                            setWithdrawalEntries(newEntries);\n                          }}\n                          data-testid={`button-remove-withdrawal-${idx}`}\n                        >\n                          <Trash2 className=\"h-4 w-4 mr-1\" /> Remove\n                        </Button>\n                      )}\n                    </div>\n                  ))}\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => {\n                      setWithdrawalEntries([...withdrawalEntries, { drugName: '', symptoms: '' }]);\n                    }}\n                    data-testid=\"button-add-withdrawal\"\n                    className=\"w-full\"\n                  >\n                    <Plus className=\"h-4 w-4 mr-1\" /> Add Another Entry\n                  </Button>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Step 10: Summary */}\n          {currentStep === 10 && (\n            <div className=\"space-y-6\" data-testid=\"step-summary\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <Check className=\"h-6 w-6 text-primary\" />\n                <h3 className=\"text-lg font-semibold\">Review Your Check-In</h3>\n              </div>\n              <p className=\"text-sm text-muted-foreground\">\n                Please review your entries below. Click on any section to go back and edit.\n              </p>\n\n              <div className=\"space-y-4\">\n                {/* Mental Health Summary */}\n                <div className=\"p-4 bg-muted/30 rounded-lg border cursor-pointer hover-elevate\" onClick={() => setCurrentStep(1)}>\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <h4 className=\"font-medium flex items-center gap-2\">\n                      <Brain className=\"h-4 w-4\" />\n                      Mental Health\n                    </h4>\n                    <Button variant=\"ghost\" size=\"sm\" type=\"button\">Edit</Button>\n                  </div>\n                  <p className=\"text-sm\"><strong>Rating:</strong> {form.watch('mentalRating')}</p>\n                  {form.watch('mentalWhy') && <p className=\"text-sm text-muted-foreground\">{form.watch('mentalWhy')}</p>}\n                </div>\n\n                {/* Sleep Summary */}\n                <div className=\"p-4 bg-muted/30 rounded-lg border cursor-pointer hover-elevate\" onClick={() => setCurrentStep(2)}>\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <h4 className=\"font-medium flex items-center gap-2\">\n                      <Moon className=\"h-4 w-4\" />\n                      Sleep\n                    </h4>\n                    <Button variant=\"ghost\" size=\"sm\" type=\"button\">Edit</Button>\n                  </div>\n                  <p className=\"text-sm\"><strong>Sleep:</strong> {form.watch('sleepStart')} - {form.watch('sleepEnd')}</p>\n                  <p className=\"text-sm\"><strong>Dreams:</strong> {form.watch('dreamType')}</p>\n                </div>\n\n                {/* Workout Summary */}\n                <div className=\"p-4 bg-muted/30 rounded-lg border cursor-pointer hover-elevate\" onClick={() => setCurrentStep(3)}>\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <h4 className=\"font-medium flex items-center gap-2\">\n                      <Dumbbell className=\"h-4 w-4\" />\n                      Workout\n                    </h4>\n                    <Button variant=\"ghost\" size=\"sm\" type=\"button\">Edit</Button>\n                  </div>\n                  {didWorkout ? (\n                    <>\n                      <p className=\"text-sm\"><strong>Date:</strong> {form.watch('workoutDate')}</p>\n                      <p className=\"text-sm\"><strong>Sessions:</strong> {workoutSessions.length}</p>\n                    </>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">No workout logged</p>\n                  )}\n                </div>\n\n                {/* Weight Summary */}\n                <div className=\"p-4 bg-muted/30 rounded-lg border cursor-pointer hover-elevate\" onClick={() => setCurrentStep(4)}>\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <h4 className=\"font-medium flex items-center gap-2\">\n                      <Scale className=\"h-4 w-4\" />\n                      Weight\n                    </h4>\n                    <Button variant=\"ghost\" size=\"sm\" type=\"button\">Edit</Button>\n                  </div>\n                  {didWeighIn && form.watch('weightLbs') ? (\n                    <p className=\"text-sm\"><strong>Weight:</strong> {form.watch('weightLbs')} lbs</p>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">No weight logged</p>\n                  )}\n                </div>\n\n                {/* Meditation Summary */}\n                <div className=\"p-4 bg-muted/30 rounded-lg border cursor-pointer hover-elevate\" onClick={() => setCurrentStep(5)}>\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <h4 className=\"font-medium flex items-center gap-2\">\n                      <Wind className=\"h-4 w-4\" />\n                      Meditation\n                    </h4>\n                    <Button variant=\"ghost\" size=\"sm\" type=\"button\">Edit</Button>\n                  </div>\n                  {didMeditate && form.watch('meditationMin') ? (\n                    <p className=\"text-sm\"><strong>Duration:</strong> {form.watch('meditationMin')} minutes</p>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">No meditation logged</p>\n                  )}\n                </div>\n\n                {/* Hobbies Summary */}\n                <div className=\"p-4 bg-muted/30 rounded-lg border cursor-pointer hover-elevate\" onClick={() => setCurrentStep(6)}>\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <h4 className=\"font-medium flex items-center gap-2\">\n                      <Home className=\"h-4 w-4\" />\n                      Hobbies\n                    </h4>\n                    <Button variant=\"ghost\" size=\"sm\" type=\"button\">Edit</Button>\n                  </div>\n                  {form.watch('yesterdayHobbies') ? (\n                    <p className=\"text-sm\">{form.watch('yesterdayHobbies')}</p>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">No hobbies logged</p>\n                  )}\n                </div>\n\n                {/* Social Summary */}\n                <div className=\"p-4 bg-muted/30 rounded-lg border cursor-pointer hover-elevate\" onClick={() => setCurrentStep(7)}>\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <h4 className=\"font-medium flex items-center gap-2\">\n                      <Heart className=\"h-4 w-4\" />\n                      Social Activities\n                    </h4>\n                    <Button variant=\"ghost\" size=\"sm\" type=\"button\">Edit</Button>\n                  </div>\n                  {form.watch('yesterdaySocial') ? (\n                    <p className=\"text-sm\">{form.watch('yesterdaySocial')}</p>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">No social activities logged</p>\n                  )}\n                </div>\n\n                {/* Recovery Summary */}\n                <div className=\"p-4 bg-muted/30 rounded-lg border cursor-pointer hover-elevate\" onClick={() => setCurrentStep(8)}>\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <h4 className=\"font-medium flex items-center gap-2\">\n                      <Coffee className=\"h-4 w-4\" />\n                      Recovery\n                    </h4>\n                    <Button variant=\"ghost\" size=\"sm\" type=\"button\">Edit</Button>\n                  </div>\n                  {didUseDrugs ? (\n                    <p className=\"text-sm\"><strong>Drugs logged:</strong> {drugEntries.filter(e => e.drugName.trim()).length}</p>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">No drug use logged</p>\n                  )}\n                  {isInRecovery && (\n                    <p className=\"text-sm\"><strong>Withdrawal entries:</strong> {withdrawalEntries.filter(e => e.drugName.trim()).length}</p>\n                  )}\n                </div>\n\n                {/* Calories Summary */}\n                <div className=\"p-4 bg-muted/30 rounded-lg border cursor-pointer hover-elevate\" onClick={() => setCurrentStep(9)}>\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <h4 className=\"font-medium flex items-center gap-2\">\n                      <Scale className=\"h-4 w-4\" />\n                      Nutrition\n                    </h4>\n                    <Button variant=\"ghost\" size=\"sm\" type=\"button\">Edit</Button>\n                  </div>\n                  {caloriesConsumed ? (\n                    <>\n                      <p className=\"text-sm\"><strong>Calories:</strong> {caloriesConsumed} kcal</p>\n                      {form.watch('proteinG') && <p className=\"text-sm\"><strong>Protein:</strong> {form.watch('proteinG')}g</p>}\n                      {goals?.kcalGoal && (\n                        <p className={`text-sm font-medium ${caloriesConsumed <= goals.kcalGoal ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'}`}>\n                          {caloriesConsumed <= goals.kcalGoal ? '✓ Under target' : 'Over target'}\n                        </p>\n                      )}\n                    </>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">No calories logged</p>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Navigation Buttons */}\n          <div className=\"flex justify-between pt-6 border-t gap-2\">\n            <div className=\"flex gap-2\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={handleBack}\n                disabled={currentStep === 1}\n                data-testid=\"button-wizard-back\"\n              >\n                <ChevronLeft className=\"h-4 w-4 mr-2\" />\n                Back\n              </Button>\n              \n              {currentStep === 1 && (\n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  onClick={() => {\n                    onClose();\n                    toast({\n                      title: 'Check-In Skipped',\n                      description: 'You can complete it later from the dashboard',\n                    });\n                  }}\n                  data-testid=\"button-already-checked-in\"\n                >\n                  Already Checked-In\n                </Button>\n              )}\n            </div>\n\n            <Button\n              type=\"button\"\n              onClick={handleNext}\n              disabled={submitCheckIn.isPending || isMeditating}\n              data-testid=\"button-wizard-next\"\n            >\n              {currentStep === totalSteps ? (\n                <>\n                  <Check className=\"h-4 w-4 mr-2\" />\n                  Complete Check-In\n                </>\n              ) : (\n                <>\n                  Next\n                  <ChevronRight className=\"h-4 w-4 ml-2\" />\n                </>\n              )}\n            </Button>\n          </div>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":65746}},"version":2}